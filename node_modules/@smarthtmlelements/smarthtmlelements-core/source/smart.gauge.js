
/* Smart HTML Elements v1.1.0 (2018-June) 
Copyright (c) 2011-2018 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart("smart-gauge",class extends Smart.Tank{static get properties(){return{analogDisplayType:{value:"needle",allowedValues:["needle","fill","line"],type:"string"},digitalDisplay:{value:!1,type:"boolean"},digitalDisplayPosition:{value:"bottom",allowedValues:["top","bottom","right","left","center"],type:"string"},drawNeedle:{value:null,type:"function?"},endAngle:{value:210,type:"number"},needlePosition:{value:"center",allowedValues:["center","edge"],type:"string"},ranges:{value:[],type:"array"},scalePosition:{value:"inside",allowedValues:["outside","inside","none"],type:"string"},showRanges:{value:!1,type:"boolean"},sizeMode:{value:"circle",allowedValues:["circle","auto"],type:"string"},startAngle:{value:-30,type:"number"}}}static get listeners(){return{down:"_downHandler",resize:"_resizeHandler",styleChanged:"_styleChangedHandler","document.move":"_documentMoveHandler","document.up":"_documentUpHandler","document.selectstart":"_selectStartHandler",keydown:"_keydownHandler"}}static get requires(){return{"Smart.Utilities.Draw":"smart.draw.js","Smart.NumericTextBox":"smart.numerictextbox.js"}}template(){return"<div id=\"container\">\n                <div class=\"smart-digital-display-container\">\n                    <smart-numeric-text-box id=\"digitalDisplay\"\n                                            class=\"smart-digital-display\"\n                                            decimal-separator=\"[[decimalSeparator]]\"\n                                            max=\"[[max]]\"\n                                            min=\"[[min]]\"\n                                            name=\"[[name]]\"\n                                            readonly\n                                            input-format=\"[[scaleType]]\"\n                                            scientific-notation=\"[[scientificNotation]]\"\n                                            show-unit=\"[[showUnit]]\"\n                                            unit=\"[[unit]]\"\n                                            unfocusable\n                                            word-length=\"[[wordLength]]\">\n                    </smart-numeric-text-box>\n                </div>\n                <div id=\"svgContainer\" class=\"smart-svg-container\"></div>\n            </div>"}attached(){const a=this;super.attached();a.isCompleted&&(a._trackListener&&(a._trackListener=new Smart.Utilities.InputEvents(a._track),a._trackListener.down(function(b){a._SVGElementDownHandler(b)})),a._fillListener&&(a._fillListener=new Smart.Utilities.InputEvents(a._fill),a._fillListener.down(function(b){a._SVGElementDownHandler(b)})),a._lineListener&&(a._lineListener=new Smart.Utilities.InputEvents(a._line),a._lineListener.down(function(b){a._SVGElementDownHandler(b)})))}detached(){const a=this;super.detached(),a._unlisten()}ready(){super.ready()}getOptimalSize(){const a=this;return a._renderingSuspended?{width:0,height:0}:"circle"===a.sizeMode?{width:a.offsetWidth,height:a._updateSize(!0)}:{width:a.offsetWidth,height:a.offsetHeight}}val(a){const b=this;if(void 0===a)return b._getEventValue();if("date"===b.mode&&(a=Smart.Utilities.DateTime.validateDate(a),a=a.getTimeStamp()),b._numericProcessor.compare(a,b.value)){if(b._validateValue(a,b.value),!b._isVisible()||b._renderingSuspended)return void(b._renderingSuspended=!0);b._updatePointer()}}_createElement(){const a=this;return"numeric"===a.mode?a._getEventValue=function(){return a.value}:(a._handleDateScale(),a.digitalDisplay=!1),a._numericProcessor=new Smart.Utilities.NumericProcessor(a,"scaleType"),a._numberRenderer=new Smart.Utilities.NumberRenderer,a._draw=new Smart.Utilities.Draw(a.$.svgContainer),a._isVisible()?void(a._renderingSuspended=!1,a._setSettingsObject(),a._wordLengthNumber=a._numericProcessor.getWordLength(a.wordLength),a._measurements={},a._validateInitialPropertyValues(),a._getMeasurements(),a._setDrawVariables(),a._getRange(),a._numericProcessor.getAngleRangeCoefficient(),"numeric"!==a.mode&&a.coerce?a._coerceInitialDateValue=!0:a._validateValue(),a._initTickIntervalHandler(),a._renderAnalogItems(),delete a._preventResizeHandler,a._setFocusable(),a._setUpdatePointerMethod()):void(a._renderingSuspended=!0)}propertyChangedHandler(a,b,c){function d(c,d,f,g){const h=c&&d?"both":a;e._validateMinMax(h,!1,b);"logarithmicScale"!==a&&"scaleType"!==a&&("wordLength"!==a&&e[a]===b||"wordLength"===a&&e.min===f&&e.max===g)||(e._setDrawVariables(),e._getRange(),e._numericProcessor.getAngleRangeCoefficient(),e._initTickIntervalHandler(),e._renderAnalogItems(),e._validateValue(),e._updatePointer())}const e=this;if(!e._isVisible()||e._renderingSuspended)return void(e._renderingSuspended=!0);switch(a){case"analogDisplayType":delete e._customSVGElements,e._getMeasurements(),"needle"===c&&"center"===e.digitalDisplayPosition?e.digitalDisplayPosition="bottom":"needle"===b&&"bottom"===e.digitalDisplayPosition&&(e.digitalDisplayPosition="center"),e._renderAnalogItems(),e._setUpdatePointerMethod();break;case"coerce":if(c){const a=e.value;e._validateValue(a),e._updatePointer(),e._valueBeforeCoercion=a}else void 0!==e._valueBeforeCoercion&&(e._validateValue(e._valueBeforeCoercion),e._updatePointer());break;case"customInterval":c?(e._customTicks&&(e.customTicks=e._customTicks),e._numericProcessor.validateCustomTicks()):"date"===e.mode&&(e._customTicks=e.customTicks),e._initTickIntervalHandler(),e._renderAnalogItems(),e._coerceCustomInterval();break;case"customTicks":if("date"===e.mode&&!e.customInterval)return e._customTicks=c,void(e.customTicks=b);e._numericProcessor.validateCustomTicks(),e.customInterval&&(e._initTickIntervalHandler(),e._renderAnalogItems(),e._coerceCustomInterval());break;case"dateLabelFormatString":case"showUnit":case"unit":e._initTickIntervalHandler(),e._renderAnalogItems();break;case"decimalSeparator":case"scientificNotation":if("date"===e.mode)return;e._initTickIntervalHandler(),e._renderAnalogItems();break;case"digitalDisplay":case"digitalDisplayPosition":if("date"===e.mode)return void("digitalDisplay"===a&&(e.digitalDisplay=!1));e._updateSize();break;case"mechanicalAction":case"messages":case"readonly":break;case"disabled":case"unfocusable":e._setFocusable();break;case"drawNeedle":if("needle"!==e.analogDisplayType)return;null===b&&e._draw.removeElement(e._needle),null===c?(e._renderAnalogItems(),delete e._customSVGElements):e._updatePointer();break;case"endAngle":case"startAngle":e._validateAngles(),e._numericProcessor.getAngleRangeCoefficient(),e._renderAnalogItems();break;case"interval":e._numericProcessor.validateInterval(e.interval),e._validateValue(),e._updatePointer();break;case"inverted":case"labelFormatFunction":case"showRanges":e._renderAnalogItems();break;case"labelsVisibility":if("all"===b&&"endPoints"===c||"endPoints"===b&&"all"===c)return;e._getMeasurements(),e._renderAnalogItems();break;case"logarithmicScale":if("date"===e.mode)return void(e.logarithmicScale=!1);e._initTickIntervalHandler(),d(!0,!0);break;case"max":case"min":"date"===e.mode&&(delete e._dateInterval,e[a]=Smart.Utilities.DateTime.validateDate(c).getTimeStamp()),d("min"===a,"max"===a);break;case"mode":e.mode=b;break;case"needlePosition":"needle"===e.analogDisplayType&&e._updatePointer();break;case"precisionDigits":case"significantDigits":if("date"===e.mode)return;"precisionDigits"===a&&"integer"===e.scaleType&&e.error(e.localize("noInteger",{elementType:e.nodeName.toLowerCase(),property:a})),"significantDigits"===a&&null!==e.precisionDigits?e.precisionDigits=null:"precisionDigits"==a&&null!==e.significantDigits&&(e.significantDigits=null),null!==c&&(e.$.digitalDisplay.precisionDigits=e.precisionDigits,e.$.digitalDisplay.significantDigits=e.significantDigits),e._initTickIntervalHandler(),e._renderAnalogItems();break;case"ranges":if(!e.showRanges)return;e._renderAnalogItems();break;case"scaleType":if("date"===e.mode)return void(e.scaleType="integer");e._numericProcessor=new Smart.Utilities.NumericProcessor(e,"scaleType"),d(!0,!0);break;case"scalePosition":case"ticksPosition":e._getMeasurements(),e._renderAnalogItems();break;case"sizeMode":e._preventResizeHandler=!0,"circle"===c?(e.$.container.removeAttribute("style"),e.style.height=e.offsetWidth+"px",e._measurements.cachedHeight=e.offsetHeight):(e.$.container.style.height=e.offsetWidth+"px",e._updateSize());break;case"theme":super.propertyChangedHandler(a,b,c),e._getMeasurements(),e._renderAnalogItems();break;case"ticksVisibility":if("minor"===b&&"major"===c||"major"===b&&"minor"===c)return;e._getMeasurements(),e._renderAnalogItems();break;case"value":{"date"===e.mode&&(c=Smart.Utilities.DateTime.validateDate(c),c=c.getTimeStamp()),e._validateValue(c,b);const a=c.toString();e.value.toString()===a&&(e._drawValue=e.logarithmicScale?Math.log10(a).toString():a),e._updatePointer();break}case"wordLength":if("date"===e.mode)return void(e.wordLength="uint64");e._wordLengthNumber=e._numericProcessor.getWordLength(e.wordLength),"integer"===e.scaleType&&d(!0,!0,e.min,e.max);}}_addAnalogDisplay(){const a=this,b=a._measurements,c=b.radius,d=a._draw;if("needle"===a.analogDisplayType){a._drawNeedle(!1);const e=b.needleWidth+5;a._centralCircle=d.circle(c,c,e,{class:"smart-needle-central-circle"}),a._minCoordinates.push(c-e),a._maxCoordinates.push(c+e)}else{const e=c-a._distance.trackDistance-b.trackBorderWidth/2-1;a._track=d.pieslice(c,c,e-b.trackWidth,e,a.startAngle,a.endAngle,0,{class:"smart-track"}),a._trackListener=new Smart.Utilities.InputEvents(a._track),a._trackListener.down(function(b){a._SVGElementDownHandler(b)})}}_calculateTickAndLabelDistance(){const a=this,b=a._measurements;if("none"===a.scalePosition)return a._plotLabels=!1,a._plotTicks=!1,b.innerRadius=b.radius,{majorTickDistance:0,minorTickDistance:0,labelDistance:0,needleDistance:0,trackDistance:0};const c=a._tickIntervalHandler.labelsSize,d=a._largestLabelSize||Math.max(c.minLabelSize,c.minLabelOtherSize,c.maxLabelSize,c.maxLabelOtherSize);let e,f,g,h=1,i=0;return a._largestLabelSize=d,"outside"===a.scalePosition&&(h=d,e=h+b.majorTickSize-b.minorTickSize,f=0),"needle"===a.analogDisplayType?(g="outside"===a.scalePosition?h+b.majorTickSize:h+b.majorTickSize+d,"none"===a.ticksVisibility&&(f=0,g-=b.majorTickSize),"none"===a.labelsVisibility&&(g-=d,"outside"===a.scalePosition&&(h-=d,e-=d))):"none"===a.labelsVisibility&&"none"===a.ticksVisibility?i=0:"outside"===a.scalePosition?"scale"===a.ticksPosition?("none"===a.labelsVisibility&&(h=1,e=1+b.majorTickSize-b.minorTickSize),i="none"===a.ticksVisibility?d:h+b.majorTickSize+2):"none"===a.labelsVisibility?(h=1,e=(b.trackWidth+b.trackBorderWidth)/4+1,i=0):(e-=(b.trackWidth+b.trackBorderWidth)/4,i=h-1):"scale"===a.ticksPosition?(h=b.trackWidth+1.5*b.trackBorderWidth+2,"none"===a.ticksVisibility&&(f=h)):e=(b.trackWidth+b.trackBorderWidth)/4+1,void 0===e&&(e=h),void 0===f&&(f=h+b.majorTickSize),b.innerRadius=b.radius-f,delete a._plotLabels,delete a._plotTicks,delete a._equalToHalfRadius,"inside"===a.scalePosition?b.innerRadius<d&&(a._plotLabels=!1,"scale"===a.ticksPosition?"needle"!==a.analogDisplayType&&(a._plotTicks=!1):(a._equalToHalfRadius=!0,b.innerRadius=b.radius/2)):b.radius-i-b.trackBorderWidth<b.trackWidth&&(b.trackWidth=b.radius-i-b.trackBorderWidth,b.lineSize=b.trackWidth+b.trackBorderWidth,"track"===a.ticksPosition&&(b.majorTickSize=b.lineSize,b.minorTickSize=b.majorTickSize/2,e=h+(b.majorTickSize-b.minorTickSize)/2)),{majorTickDistance:h,minorTickDistance:e,labelDistance:f,needleDistance:g,trackDistance:i}}_calculateTickInterval(){const a=this,b=a._tickIntervalHandler.getInterval("radial",a._drawMin,a._drawMax,a.$.container,a.logarithmicScale);b.major===a._majorTicksInterval?a._intervalHasChanged=!0:(a._intervalHasChanged=!0,a._majorTicksInterval=b.major),a._minorTicksInterval=b.minor,"date"===a.mode&&a._calculateDateInterval(b.major)}_computeNeedlePointsCenter(a,b){const c=this,d=c._measurements,e=d.innerRadius,f=d.radius,g=Math.sin(b),h=Math.cos(b);let i="inside"===c.scalePosition?.9*(e-c._largestLabelSize):.9*(e-c._distance.needleDistance);const j=f+i*g,k=f+i*h;return"M "+(f+a*h)+","+(f-a*g)+" L "+(f-a*h)+","+(f+a*g)+" L "+j+","+k+" Z"}_computeNeedlePointsEdge(a,b,c){const d=this,e=d._measurements.radius,f=e-d._distance.needleDistance,g=f-c,h=Math.sin(b),i=Math.cos(b),j=e+g*h,k=e+g*i;return"M "+(j+a*i)+","+(k-a*h)+" L "+(j-a*i)+","+(k+a*h)+" L "+(e+f*h)+","+(e+f*i)+" Z"}_documentMoveHandler(a){if(!this._dragging)return;const b=this,c=b._getAngleByCoordinate(a.pageX,a.pageY),d=b._getQuadrant(c),e=b._getRotationDirection();if(b._normalizedStartAngle===b.endAngle){let a;b.inverted?b._lockCW&&"cw"===e?(a=b._normalizedStartAngle,b._unlockRotation("_lockCW",c,d,a,{firstCondition:c<a,secondCondition:c>a})):b._lockCCW&&"ccw"===e&&(a=b.endAngle,b._unlockRotation("_lockCCW",c,d,a,{firstCondition:c>a,secondCondition:c<a})):b._lockCW&&"ccw"===e?(a=b.endAngle,b._unlockRotation("_lockCW",c,d,a,{firstCondition:c>a,secondCondition:c<a})):b._lockCCW&&"cw"===e&&(a=b._normalizedStartAngle,b._unlockRotation("_lockCCW",c,d,a,{firstCondition:c<a,secondCondition:c>a}))}else b._lockCW&&"ccw"===e&&!b._outsideRange&&10>b._numericProcessor._getAngleDifference(c,b._normalizedStartAngle)?b._lockCW=!1:b._lockCCW&&"cw"===e&&!b._outsideRange&&10>b._numericProcessor._getAngleDifference(c,b.endAngle)&&(b._lockCCW=!1);if(b._angle=c,b._quadrant=d,a.originalEvent&&(a.originalEvent.stopPropagation(),a.originalEvent.preventDefault()),b._lockCW||b._lockCCW)return;let f=b._numericProcessor.getValueByAngle(c);if(b._normalizedStartAngle===b.endAngle){const a=b._numericProcessor.lockRotation("cw"===e&&!b.inverted||"ccw"===e&&b.inverted,f);void 0!==a&&(f=a)}else"ccw"===e&&b._outsideEnd?b._lockCCW=!0:"cw"===e&&b._outsideStart&&(b._lockCW=!0);void 0!==f&&b._numericProcessor.compare(f,b.value)&&(b._updatePointer(f),"switchWhenReleased"===b.mechanicalAction?b._valueAtMoveEnd=f:b._numericProcessor.updateGaugeValue(f))}_documentUpHandler(){const a=this;if(a._dragging&&(a._lockCW=!1,a._lockCCW=!1,a._dragging=!1,a.removeAttribute("dragged"),"switchWhileDragging"!==a.mechanicalAction)){const b="switchUntilReleased"===a.mechanicalAction?a._valueAtDragStart:a._valueAtMoveEnd;a._numericProcessor.compare(b,a.value)&&(a._updatePointer(b),a._numericProcessor.updateGaugeValue(b))}}_downHandler(a,b){var c=Math.pow;const d=this;if("needle"!==d.analogDisplayType&&!b||d.disabled||d.readonly||"buttons"in a&&1!==a.buttons||1!==a.which)return void a.stopPropagation();const e=a.pageX,f=a.pageY;if(d._measurements.center=d._getCenterCoordinates(),"needle"===d.analogDisplayType){const b=Math.sqrt(c(d._measurements.center.x-e,2)+c(d._measurements.center.y-f,2));if(b>d._measurements.radius)return void a.stopPropagation()}"switchUntilReleased"===d.mechanicalAction&&(d._valueAtDragStart=d.value),d._angle=d._getAngleByCoordinate(e,f),d._quadrant=d._getQuadrant(d._angle);const g=d._numericProcessor.getValueByAngle(d._angle);void 0!==g&&d._numericProcessor.compare(g,d.value)&&(d._updatePointer(g),"switchWhenReleased"===d.mechanicalAction?d._valueAtMoveEnd=g:d._numericProcessor.updateGaugeValue(g)),d._dragging=!0,d.setAttribute("dragged","")}_drawFill(a,b){const c=this;if("needle"!==c.analogDisplayType){void 0===b&&(b=c._number);const d=c._measurements,e=d.radius,f=e-c._distance.trackDistance-d.trackBorderWidth/2-1;if("fill"===c.analogDisplayType){const g=c._numericProcessor.getAngleByValue(b,!0,!0);let h,i;c.inverted?(h=c.startAngle,i=g):(h=g,i=c.endAngle),a?c._fill.setAttribute("d",c._draw.pieSlicePath(e,e,f-d.trackWidth,f,h,i,0)):(c._fill=c._draw.pieslice(e,e,f-d.trackWidth,f,h,i,0,{class:"smart-value"}),c._fillListener=new Smart.Utilities.InputEvents(c._fill),c._fillListener.down(function(a){c._SVGElementDownHandler(a)}))}else{const g=f+d.trackBorderWidth/2,h=g-d.lineSize,i=c._numericProcessor.getAngleByValue(b),j=Math.sin(i),k=Math.cos(i),l=e+g*j,m=e+g*k,n=e+h*j,o=e+h*k;a?(c._line.setAttribute("x1",l),c._line.setAttribute("y1",m),c._line.setAttribute("x2",n),c._line.setAttribute("y2",o)):(c._line=c._draw.line(l,m,n,o,{class:"smart-line"}),c._lineListener=new Smart.Utilities.InputEvents(c._line),c._lineListener.down(function(a){c._SVGElementDownHandler(a)}))}}}_drawLabel(a,b,c,d){var e=Math.round;const f=this,g=f._measurements,h=g.radius,i={class:"smart-label"+(!1===d?"":" smart-label-middle"),"font-size":g.fontSize,"font-family":g.fontFamily,"font-weight":g.fontWeight,"font-style":g.fontStyle};b=f._formatLabel(b.toString(),!1);const j=f._draw.measureText(b,0,i),k=h-c-f._largestLabelSize/2,l=e(h+k*Math.sin(a))-j.width/2,m=e(h+k*Math.cos(a))-j.height/2,n=f._draw.text(b,l,m,j.width,j.height,0,i);f._minCoordinates.push(m),f._maxCoordinates.push(m+n.getBBox().height)}_drawNeedle(a,b){const c=this,d=c._measurements;b===void 0&&(b=c._number);const e=c._numericProcessor.getAngleByValue(b);if(!c.drawNeedle){let b;b="center"===c.needlePosition?c._computeNeedlePointsCenter(d.needleWidth,e):c._computeNeedlePointsEdge(d.needleWidth,e,d.needleLength),a?c._needle.setAttribute("d",b):c._needle=c._draw.path(b,{class:"smart-needle"})}else if(c._customSVGElements=c.drawNeedle(c,c._draw,d.radius,e,c._distance.needleDistance),c._customSVGElements){const a=c._customSVGElements[0].parentElement||c._customSVGElements[0].parentNode;for(let b=0;b<c._customSVGElements.length;b++)a.insertBefore(c._customSVGElements[b],c._centralCircle)}}_drawRanges(){const a=this,b=a._numericProcessor,c=a.ranges;if(!a.showRanges||0===c.length)return;const d=a._measurements,e=d.radius;let f,g,h,j;"needle"===a.analogDisplayType?(g=d.rangeSize,"inside"===a.scalePosition?f=e-1:(f=e-a._distance.needleDistance-2,"none"===a.labelsVisibility&&"none"===a.ticksVisibility&&(f+=1))):(f=e-a._distance.trackDistance-d.trackBorderWidth/2-1,g=d.trackWidth),a.inverted?(h="endValue",j="startValue"):(h="startValue",j="endValue");for(let d=0;d<c.length;d+=1){let i=c[d],k=b.validateColorRange(i[h]),l=b.validateColorRange(i[j]);const m=a._draw.pieslice(e,e,f-g,f,b.getAngleByValue(l,!0,!0),b.getAngleByValue(k,!0,!0),0,{class:"smart-range "+i.className});a._ranges.push(m)}}_drawTick(a,b,c){var d=Math.cos,e=Math.sin;const f=this,g=f._measurements,h=g.radius;let i,j="smart-tick";"major"===c?i=g.majorTickSize:(i=g.minorTickSize,j+=" smart-tick-minor");const k=b-i,l=h+b*e(a),m=h+b*d(a),n=h+k*e(a),o=h+k*d(a);f._draw.line(l,m,n,o,{class:j}),f._minCoordinates.push(Math.min(m,o)),f._maxCoordinates.push(Math.max(m,o))}_getAngleByCoordinate(a,b){const c=this,d=c._measurements.center,e=Math.atan2(b-d.y,a-d.x);let f=180*(-1*e)/Math.PI;return 0>f&&(f+=360),c._actualAngle=f,c._normalizedStartAngle===c.endAngle||function(a,b,c){for(;b<a;)b+=360;for(;c<a;)c+=360;return c>=a&&c<=b}(c._normalizedStartAngle,c.endAngle,f)?(c._outsideRange=!1,c._outsideStart=!1,c._outsideEnd=!1):(c._numericProcessor._getAngleDifference(f,c._normalizedStartAngle)<=c._numericProcessor._getAngleDifference(f,c.endAngle)?(f=c._normalizedStartAngle,c._outsideStart=!0,c._outsideEnd=!1):(f=c.endAngle,c._outsideEnd=!0,c._outsideStart=!1),c._outsideRange=!0),f}_getCenterCoordinates(){const a=this,b=a.$.container.getBoundingClientRect(),c=a._measurements.radius,d=document.body.scrollLeft||document.documentElement.scrollLeft,e=document.body.scrollTop||document.documentElement.scrollTop;return{x:b.left+d+c,y:b.top+e+c}}_getInlineColors(){const a=this;let b="",c="",d="";return a._track&&(b=a._track.style.fill),a._fill&&(c=a._fill.style.fill),a._line&&(d=a._line.style.stroke),[b,c,d]}_getMeasurements(){const a=this;if(!a._isVisible()||a._renderingSuspended)return void(a._renderingSuspended=!0);const b=a._measurements;b.cachedWidth=a.offsetWidth,b.cachedHeight=a.offsetHeight,b.radius=b.cachedWidth/2;const c=document.createElement("div");a.appendChild(c),c.className="smart-tick",b.majorTickSize=c.offsetWidth,c.className+=" smart-tick-minor",b.minorTickSize=c.offsetWidth,c.className="smart-label";const d=window.getComputedStyle(c);b.fontSize=d.fontSize,b.fontFamily=d.fontFamily,b.fontWeight=d.fontWeight,b.fontStyle=d.fontStyle,b.trackWidth=0,b.trackBorderWidth=0,"needle"===a.analogDisplayType?(c.className="smart-needle",b.needleWidth=c.offsetWidth,b.needleLength=c.offsetHeight,c.className="smart-range",b.rangeSize=c.offsetWidth):(c.className="smart-track",b.trackBorderWidth=parseFloat(d.strokeWidth),b.trackWidth=Math.min(c.offsetWidth,b.radius-b.trackBorderWidth),b.lineSize=b.trackWidth+b.trackBorderWidth,"track"===a.ticksPosition&&(b.majorTickSize=b.lineSize,b.minorTickSize=b.majorTickSize/2)),a.removeChild(c)}_getQuadrant(a){return 270<a?4:180<a?3:90<a?2:1}_getRotationDirection(){const a=this,b=a._getQuadrant(a._actualAngle);return a._actualAngle<a._angle&&(1!==b||4!==a._quadrant)||a._actualAngle>a._angle&&4===b&&1===a._quadrant?"cw":"ccw"}_initTickIntervalHandler(){const a=this;if(!a._isVisible()||a._renderingSuspended)return void(a._renderingSuspended=!0);const b=a._formatLabel(a.min,!1),c=a._formatLabel(a.max,!1);a._tickIntervalHandler=new Smart.Utilities.TickIntervalHandler(a,b,c,"smart-label",a._settings.size,"integer"===a.scaleType,a.logarithmicScale)}_keydownHandler(a){const b=this,c=b._getEventValue(),d=b._number.toString();"numeric"===b.mode?(b.value.toString()!==d&&(b.value=d,b.$.digitalDisplay.value=d),super._keydownHandler(a),b.value.toString()!==c&&b.$.fireEvent("change",{value:b.value,oldValue:c})):(b.value.toString()!==d&&(b._valueDate=Smart.Utilities.DateTime.fromFullTimeStamp(d),b.value=b._number),super._keydownHandler(a),0!==b._valueDate.compare(c)&&b.$.fireEvent("change",{value:b._getEventValue(),oldValue:c}))}_normalizeAngle(a){return a%=360,0>a&&(a+=360),a}_renderAnalogItems(a){const b=this;if(!b._isVisible()||b._renderingSuspended)return void(b._renderingSuspended=!0);const c=b._getInlineColors();if(b._unlisten(),b._draw.clear(),delete b._needle,delete b._centralCircle,delete b._track,delete b._trackListener,delete b._fill,delete b._fillListener,delete b._line,delete b._lineListener,b._ranges=[],b._minCoordinates=[],b._maxCoordinates=[],!1!==a&&(delete b._largestLabelSize,b._distance=b._calculateTickAndLabelDistance()),!1!==b._plotTicks&&!1!==b._plotLabels){b._calculateTickInterval();const c=b._cachedLabelsSize,d=Math.max(c.minLabelSize,c.minLabelOtherSize,c.maxLabelSize,c.maxLabelOtherSize);!1!==a&&b._largestLabelSize!==d&&(b._largestLabelSize=d,b._distance=b._calculateTickAndLabelDistance(),b._calculateTickInterval())}b._coerceInitialDateValue&&(b._validateValue(),delete b._coerceInitialDateValue),b._drawRanges(),b._addAnalogDisplay(),"none"===b.ticksVisibility&&"none"===b.labelsVisibility||!1===b._plotTicks&&!1===b._plotLabels||(b.customInterval||b._dateInterval?b._numericProcessor.addGaugeCustomTicks():b._numericProcessor.addGaugeTicksAndLabels()),b._drawFill(!1),b._updateSize(),b._restoreInlineColors(c[0],c[1],c[2])}_resizeHandler(){const a=this;if(a._preventResizeHandler)return void delete a._preventResizeHandler;if(!a._isVisible())return void(a._renderingSuspended=!0);if(a._renderingSuspended)return void a._createElement();const b=a._measurements;if(!(a._renderingSuspended||b.cachedWidth===a.offsetWidth&&b.cachedHeight===a.offsetHeight)){if("circle"===a.sizeMode)a.offsetWidth!==a.offsetHeight&&(b.cachedWidth===a.offsetWidth?b.cachedHeight!==a.offsetHeight&&(a.style.width=a.offsetHeight+"px",a._preventResizeHandler=!0):(a.style.height=a.offsetWidth+"px",a._preventResizeHandler=!0));else{if(b.cachedHeight!==a.offsetHeight&&b.cachedWidth===a.offsetWidth)return a.style.height=b.cachedHeight+"px",void(a._preventResizeHandler=!0);a.$.container.style.height=a.offsetWidth+"px"}b.cachedWidth=a.offsetWidth,b.cachedHeight=a.offsetHeight,b.radius=b.cachedWidth/2,b.innerRadius=a._equalToHalfRadius?b.radius/2:b.radius-a._distance.labelDistance,a._renderAnalogItems(!1)}}_restoreInlineColors(a,b,c){const d=this;d._track&&""!==a&&(d._track.style.fill=a),d._fill&&""!==b&&(d._fill.style.fill=b),d._line&&""!==c&&(d._line.style.stroke=c)}_selectStartHandler(a){this._dragging&&a.preventDefault()}_setUpdatePointerMethod(){const a=this;a._updatePointer="needle"===a.analogDisplayType?function(b){if(a._customSVGElements)for(let b=0;b<a._customSVGElements.length;b++)a._draw.removeElement(a._customSVGElements[b]);a._drawNeedle(!0,b)}:function(b){a._drawFill(!0,b)}}_styleChangedHandler(a){const b=this;return a.detail.styleProperties["min-height"]?void 0:b._isVisible()?b._renderingSuspended?void b._createElement():void(b._getMeasurements(),b._initTickIntervalHandler(),b._renderAnalogItems()):void(b._renderingSuspended=!0)}_SVGElementDownHandler(a){const b=this,c=b.context;b.context=b,b._downHandler(a,!0),b.context=c}_unlockRotation(a,b,c,d,e){const f=this,g=e.firstCondition,h=e.secondCondition,i=f._getQuadrant(d);(g&&(4!==c||1!==i)||h&&4===c&&1===i)&&10>f._numericProcessor._getAngleDifference(b,d)&&(f[a]=!1)}_updateSize(a){var b=Math.min,c=Math.max;const d=this;if("circle"===d.sizeMode&&void 0===a)return;const e=d._minCoordinates,f=d._maxCoordinates;let g=e[0],h=f[0];for(let c=1;c<e.length;c++)g=b(g,e[c]);for(let b=1;b<f.length;b++)h=c(h,f[b]);const j=d.getBoundingClientRect();if(d.digitalDisplay){const a=d.$.digitalDisplay.getBoundingClientRect();g=b(g,a.top-j.top),h=c(h,a.bottom-j.top)}if("needle"!==d.analogDisplayType){const a=d._track.getBBox();g=b(g,a.y),h=c(h,a.y+a.height)}for(let e=0;e<d._ranges.length;e++){const a=d._ranges[e].getBBox();g=b(g,a.y-j.top),h=c(h,a.y+a.height-j.top)}g-=2;const i=h-g;return void 0===a?void(d._preventResizeHandler=!0,d.style.height=i+"px",d.$.container.style.marginTop=-1*g+"px",d._measurements.cachedHeight=i):Math.round(i)}_updateValue(a){this._numericProcessor.updateGaugeValue(a)}_validate(a,b){const c=this;c._validateValue(b),c._updatePointer()}_validateAngles(){const a=this;a._normalizedStartAngle=a._normalizeAngle(a.startAngle),a.endAngle=a._normalizeAngle(a.endAngle),a.startAngle=a._normalizedStartAngle<a.endAngle?a._normalizedStartAngle:a._normalizedStartAngle-360,a._angleDifference=a.endAngle-a.startAngle}_validateInitialPropertyValues(){super._validateInitialPropertyValues();const a=this;"circle"===a.sizeMode?a.offsetWidth<a.offsetHeight?a.style.height=a.offsetWidth+"px":a.offsetWidth>a.offsetHeight&&(a.style.width=a.offsetHeight+"px"):(a.offsetHeight!==a.offsetWidth&&(a.style.height=a.offsetWidth+"px"),a.$.container.style.height=a.offsetWidth+"px"),a._validateAngles(),null===a.significantDigits?null!==a.precisionDigits&&(a.$.digitalDisplay.precisionDigits=a.precisionDigits):a.$.digitalDisplay.significantDigits=a.significantDigits}_validateValue(a,b){const c=this,d=c._numericProcessor,e=c.logarithmicScale;a=void 0===a?c.value:a.toString(),d.regexScientificNotation.test(a)&&(a=d.scientificToDecimal(a)),isNaN(a)&&(a=b||0);let f,g,h;c.coerce?(f=d.getCoercedValue(d.createDescriptor(a,!0,!0,!0),!1,e),c._number=f,g=f.toString(),h=g):(f=d.getCoercedValue(d.createDescriptor(a,!0,!0,!1),!1,e),c._number=d.validate(f,d.createDescriptor(c._minObject),d.createDescriptor(c._maxObject)),g=f.toString(),h=c._number.toString()),"numeric"===c.mode?(c.value=g,c.$.digitalDisplay.value=g):(c._valueDate=Smart.Utilities.DateTime.fromFullTimeStamp(g),c.value=f),c._drawValue=e?Math.log10(h).toString():h,delete c._valueBeforeCoercion}_unlisten(){const a=this;a._trackListener&&a._trackListener.unlisten(),a._fillListener&&a._fillListener.unlisten(),a._lineListener&&a._lineListener.unlisten()}});