
/* Smart HTML Elements v1.1.0 (2018-June) 
Copyright (c) 2011-2018 jQWidgets. 
License: https://htmlelements.com/license/ */

class GridColumn{constructor(e){const t=this;Object.getOwnPropertyNames(e).forEach(function(l){t["_"+l]=e[l]}),t._dataType||(t._dataType="string");let l="left";switch(t._dataType){case"string":case"date":l="left";break;case"number":l="right";break;case"boolean":l="center";}t._label||(t._label="","string"==typeof e&&(t._label=e,t._dataField=e)),t._displayField||(t._displayField=t._dataField),t._sortOrder||(t._sortOrder=null),t._sortIndex||(t._sortIndex=null),t._align||(t._align=l),t._cellsAlign||(t._cellsAlign=l),t._minWidth||(t._minWidth=30),t._width||(t._width="auto"),t._visible===void 0&&(t._visible=!0),t._allowResize===void 0&&(t._allowResize=!0),t._allowReorder===void 0&&(t._allowReorder=!0),t._allowSort===void 0&&(t._allowSort=!0),t._allowFilter===void 0&&(t._allowFilter=!0),t._allowEdit===void 0&&(t._allowEdit=!0),t._allowExport===void 0&&(t._allowExport=!0),t._summary||(t._summary=[]),t.__cellsCachedValues=[],Object.getOwnPropertyNames(t).forEach(function(e){const l=e.substring(1);Object.defineProperty(t,l,{configurable:!0,enumerable:!0,get:function(){return t[e]},set:function(l){const a=t[e];t[e]=l;a===l||t.propertyChanged&&t.propertyChanged(e,a,l)}})})}}class GridRow{constructor(){}}Smart("smart-grid",class extends Smart.BaseElement{static get properties(){return{adaptivityMode:{value:{responsiveLayout:{value:{enabled:{value:!1,type:"boolean"},autoShowHiddenCells:{value:!0,type:"boolean"},width:{value:900,type:"number"}},type:"object"},adaptiveLayout:{value:{enabled:{value:!1,type:"boolean"},width:{value:450,type:"number"}},type:"object"}},type:"object"},allowColumnReorder:{value:!1,type:"boolean"},allowRowReorder:{value:!1,type:"boolean"},allowColumnResize:{value:!1,type:"boolean"},allowRowResize:{value:!1,type:"boolean"},allowColumnFixing:{value:!1,type:"boolean"},appearance:{value:{alternationStart:{value:0,type:"int"},alternationEnd:{value:0,type:"int"},alternationCount:{value:0,type:"int"},allowRowToggleAnimation:{value:!0,type:"boolean"},allowSortAnimation:{value:!1,type:"boolean"},sortAnimationDuration:{value:600,type:"number"},showRowNumber:{value:!1,type:"boolean"},showRowGroupLabel:{value:!0,type:"boolean"},showRowGroupCount:{value:!0,type:"boolean"},showColumnHeaderLines:{value:!0,type:"boolean",defaultReflectToAttribute:!0},showColumnLines:{value:!0,type:"boolean",defaultReflectToAttribute:!0},showRowLines:{value:!0,type:"boolean",defaultReflectToAttribute:!0},showFilterColumnBackground:{value:!1,type:"boolean"},showSortColumnBackground:{value:!1,type:"boolean"},showTooltips:{value:!0,type:"boolean"}},type:"object"},columns:{value:[],type:"object",reflectToAttribute:!1},columnChooser:{value:{allowSearch:{value:!1,type:"boolean"},visible:{value:!1,type:"boolean"},label:{value:"Column Chooser",type:"string"},mode:{value:"dragAndDrop",type:"string",allowedValues:["select","dragAndDrop"]},placeholder:{value:"Drag a column here to hide it",type:"string"},width:{value:250,type:"number"},height:{value:200,type:"number"}},type:"object"},columnGroups:{value:[],type:"array",reflectToAttribute:!1},columnHeight:{value:null,type:"any",reflectToAttribute:!1},"columnResizeMode ":{value:"nextColumn",type:"string",allowedValues:["nextColumn","element"]},dataSource:{value:null,type:"object",reflectToAttribute:!1},messages:{extend:!0,value:{en:{fixedColumns:"{{elementType}}: To Pin/Freeze a column group, all columns within it should be fixed.",fixedRows:"{{elementType}}: To Pin/Freeze a special cell, all rows within it should be fixed.",columnGroups:"{{elementType}}: Please, check the initialization of the smartGrid's columns array. The columns in a column group are expected to be siblings in the columns array.",min:"Min: {{value}}",max:"Max: {{value}} ",sum:"Sum: {{value}} ",avg:"Avg: {{value}} ",count:"Count: {{value}} "}},type:"object"},specialCells:{value:[],type:"array",reflectToAttribute:!1},filter:{value:{filterExpression:{value:null,type:"object"},filterRow:{value:{visible:{value:!1,type:"boolean"},menuVisible:{value:!1,type:"boolean"},applyMode:{value:"auto",type:"string",allowedValues:["auto","click"]},autoApplyModeDelay:{value:300,type:"number"}},type:"object"},filterDropDown:{value:{allowSearch:{value:!1,type:"boolean"},visible:{value:!1,type:"boolean"},width:{value:250,type:"number"},height:{value:200,type:"number"}},type:"object"},filterFooter:{value:{visible:{value:!1,type:"boolean"},height:{value:null,type:"number?"}},type:"object"}},type:"object"},editMode:{value:"none",allowedValues:["none","batch","inline","editForm","editFormAndDisplayRow","popupEditForm"],type:"string"},rows:{value:[],type:"array",reflectToAttribute:!1},pager:{value:{position:{value:"near",allowedValues:["near","far"],type:"string"},template:{value:"",type:"string"},sizeRowDropDownList:{value:{visible:{value:!1,type:"boolean"},dataSource:{value:[10,20,50],type:"object"},position:{value:"near",allowedValues:["near","far"],type:"string"}},type:"object"},summary:{value:{visible:{value:!1,type:"boolean"}},type:"object"},numericButtons:{value:{visible:{value:!1,type:"boolean"}},type:"object"},visible:{value:!1,type:"boolean"}},type:"object",reflectToAttribute:!1},placeholder:{value:"No Rows",type:"string"},rowDetail:{value:{autoExpandAll:{value:!1,type:"boolean"},allowToggleAnimation:{value:!0,type:"boolean"},enabled:{value:!1,type:"boolean"},visible:{value:!0,type:"boolean"},template:{value:"",type:"any"},height:{value:200,type:"number"}},type:"object"},rowAdaptiveDetail:{value:{autoExpandAll:{value:!1,type:"boolean"},allowToggleAnimation:{value:!0,type:"boolean"},enabled:{value:!1,type:"boolean"},visible:{value:!0,type:"boolean"},template:{value:"",type:"any"},height:{value:200,type:"number"}},type:"object"},rowMinHeight:{value:25,type:"number"},rowHeight:{value:null,type:"any",reflectToAttribute:!1},rowResizeMode:{value:"nextRow",type:"string",allowedValues:["nextRow","element"]},hierarchySummaryRow:{value:{position:{value:"far",allowedValues:["near","far"],type:"string"},visible:{value:!1,type:"boolean"},template:{value:"",type:"string"}},type:"object"},summaryRow:{value:{position:{value:"far",allowedValues:["near","far"],type:"string"},visible:{value:!1,type:"boolean"},template:{value:"",type:"string"}},type:"object"},newRow:{value:{position:{value:"far",allowedValues:["near","far"],type:"string"},visible:{value:!1,type:"boolean"},label:{value:"Click here to add a new row",type:"string"},template:{value:"",type:"string"}},type:"object"},columnHeader:{value:{visible:{value:!0,type:"boolean"}},type:"object"},groupHeader:{value:{visible:{value:!1,type:"boolean"},template:{value:"",type:"string"}},type:"object"},header:{value:{visible:{value:!1,type:"boolean"},template:{value:"",type:"string"}},type:"object"},footer:{value:{visible:{value:!1,type:"boolean"},template:{value:"",type:"string"}},type:"object"},selectionMode:{value:"default",allowedValues:["none","default","zeroOrMany","oneOrMany","zeroOrOne","one","checkBox","radioButton"],type:"string"},sortMode:{value:"none",allowedValues:["none","one","many"],type:"string"}}}static get requires(){return{"Smart.Button":"smart.button.js","Smart.ScrollBar":"smart.scrollbar.js"}}template(){return`<div class=\'smart-container\'id=\'container\' disabled=\'[[disabled]]\' role=\'grid\'>
            <div id=\'header\' class=\'smart-grid-header smart-hidden\' ></div>
            <div id=\'groupHeader\' class=\'smart-grid-group-header smart-hidden\'></div>
            <div id=\'headerPager\' top class=\'smart-grid-pager smart-hidden\'></div>
             <div id=\'content\' class=\'smart-grid-content\'>
                <div id=\'placeholder\' class =\'smart-placeholder\'>[[placeholder]]</div>
                <div id=\'columnHeader\' class=\'smart-grid-column-header\'>
                    <div id=\'columnNearContainerElement\' class=\'near smart-grid-column-header-cell-container\'>
                   </div>
                   <div id=\'columnContainerElement\' class=\'center smart-grid-column-header-cell-container\'>
                   </div>
                    <div id=\'columnFarContainerElement\' class=\'far smart-grid-column-header-cell-container\'>
                   </div>
                </div>
                <div id=\'scrollView' class =\'smart-grid-scroll-view\'>
                    <div id=\'rowNearContainer\' class=\'near smart-grid-row-container\'>
                    </div>
                     <div id=\'rowContainer\' class=\'center smart-grid-row-container\'>
                    </div>
                    <div id=\'rowFarContainer\' class=\'far smart-grid-row-container\'>
                    </div>
                    <div id=\'specialCellsContainer\' class=\'smart-hidden smart-grid-special-cells-container\'>
                    </div>
                    <smart-scroll-bar id=\'verticalScrollBar\' disabled=\'[[disabled]]\' orientation=\'vertical\'></smart-scroll-bar>
                    <smart-scroll-bar id=\'horizontalScrollBar\' disabled=\'[[disabled]]\'></smart-scroll-bar>
                </div>
              <div id=\'filterFooter\' class=\'smart-grid-filter-footer smart-hidden\'></div>
            </div>
            <div id=\'loadingIndicatorContainer\' class=\'smart-loader-container\'>
                <span id=\'loadingIndicator\' class=\'smart-loader\'></span>
                <span id=\'loadingIndicatorPlaceHolder\' class =\'smart-loader-label smart-hidden\'>[[loadingIndicatorPlaceholder]]</span>
            </div>
            <div id=\'footerPager\' class=\'smart-grid-pager smart-hidden\'></div>
            <div id=\'footer\' class=\'smart-grid-footer smart-hidden\'></div>
        </div>`}static get listeners(){return{focus:"_focusHandler",blur:"_blurHandler",wheel:"_mouseWheelHandler","horizontalScrollBar.change":"_horizontalScrollbarHandler","document.up":"_upHandler","document.move":"_moveHandler",keydown:"_keyDownHandler",keyup:"_keyUpHandler",resize:"_resizeHandler","columnHeader.down":"_columnDownHandler","rowNearContainer.down":"_downHandler","rowContainer.down":"_downHandler","rowFarContainer.down":"_downHandler",selectstart:"_selectStartHandler",styleChanged:"_styleChangedHandler",swipeleft:"_swipeLeftHandler",swiperight:"_swipeRightHandler","verticalScrollBar.change":"_verticalScrollbarHandler"}}_toggleRow(e){const t=this,l=e.rowElement;t._toggledRow=l.row;const a=function(e){const l=t._scrollView.scrollLeft;t._refreshLayout(),t._initializeColumnHeaderResponsiveBounds(),t._recycle(),t._scrollView.scrollLeft=l,e&&e()};if(t.appearance.allowRowToggleAnimation&&l.toggleArrow.classList.add("animation"),e.allowToggle){const e=function(){t._refreshRowHierarchy(),a();let e=0;for(let l=0;l<t.rowHierarchy.length;l++){const a=t.rowHierarchy[l];for(let l=a.parent;l;)l.uid===t._toggledRow.uid&&(e+=a.height),l=l.parent}t._toggledRow.expandHeight=e,t._toggledRow.height=t._toggledRow.cellHeight+t._toggledRow.expandHeight};if(!t.appearance.allowRowToggleAnimation)t._toggledRow.expanded=!t._toggledRow.expanded,a();else{const o=function(e){t._toggledRow&&"height"===e.propertyName&&(t._toggledRow.rowElement.classList.remove("animation"),t._toggledRow.rowElement.rowContainer.innerHTML="",t._toggledRow.rowElement.rowContainer.classList.add("smart-hidden"),t._toggledRow.height=t._toggledRow.cellHeight,t._toggledRow.rowElement.removeEventListener("transitionend",o),t._toggledRow.rowElement.removeEventListener("transitioncancel",o),t._toggledRow=null,a())};if(l.classList.remove("animation"),l.addEventListener("transitionend",o),l.addEventListener("transitioncancel",o),!t._toggledRow.expanded)l.classList.add("animation"),t._toggledRow.expanded=!0,e(),a();else{e(),a(function(){l.toggleArrow.classList.remove("smart-arrow-down"),l.toggleArrow.classList.add("smart-arrow-right"),t._toggledRow.expanded=!1,t._toggledRow.height=t._toggledRow.cellHeight,a()}),l.classList.add("animation")}}}}_columnDownHandler(e){const t=this,l=document.elementsFromPoint(e.pageX,e.pageY);let a=null;for(let t=0;t<l.length;t++){const e=l[t];e.getAttribute("data-field")&&(a=e.getAttribute("data-field"))}a&&t.sortBy(a)}addTransformMoveStyle(e,t,l,a,o,n){e.style.opacity=n,e.style["transition-duration"]=t,e.style.transform="translate3d("+l+"px,"+a+"px,"+o+"px)"}removeTransformMoveStyle(e){e.style.opacity="",e.style["transition-duration"]="",e.style.transform=""}_updateColumnHeaderCellElementWidth(e){e.headerCellElement.labelElement.style.width="calc(100% - "+e.headerCellElement.iconContainerElement.offsetWidth+"px)"}sortBy(e,t){var l=Math.floor;const a=this,o=a.columnByDataField[e],n=[],s=[],d=[];let r=t||"asc";const c=function(e){e.headerCellElement.sortIconContainerElement.classList.add("smart-hidden"),e.headerCellElement.sortIconContainerElement.classList.remove("sort-descending-icon"),e.headerCellElement.sortIconContainerElement.classList.remove("sort-ascending-icon"),e.sortOrder=null,a._updateColumnHeaderCellElementWidth(e)},h=function(){if(0<a._sortColumns.length)for(let e=0;e<a._sortColumns.length;e++){const t=a._sortColumns[e],l=a.columnByDataField[t.dataField];c(l)}a._sortColumns=[]};if(null===o)return void h();if("none"===a.sortMode||!a.dataSource||!o.allowSort||a._sortAnimation)return;c(o),a._sortColumns||(a._sortColumns=[]);let m="string";for(let l=0;l<a.dataSource.dataFields.length;l++){const t=a.dataSource.dataFields[l];if(t.name===e){m=t.dataType;break}}let u=!0;for(let l=0;l<a._sortColumns.length;l++){const t=a._sortColumns[l];if(t.dataField===e)if(u=!1,"asc"===t.direction)t.direction="desc",r="desc";else if("desc"===t.direction){a._sortColumns.splice(l,1),c(o),r=null;break}}u&&("one"===a.sortMode&&h(),a._sortColumns.push({dataField:e,direction:r,dataType:m})),null===r?o.headerCellElement.sortIconContainerElement.classList.add("smart-hidden"):(o.headerCellElement.sortIconContainerElement.classList.remove("smart-hidden"),o.headerCellElement.sortIconContainerElement.classList.remove("sort-descending-icon"),o.headerCellElement.sortIconContainerElement.classList.remove("sort-ascending-icon"),o.sortOrder=r,"desc"===r?o.headerCellElement.sortIconContainerElement.classList.add("sort-descending-icon"):o.headerCellElement.sortIconContainerElement.classList.add("sort-ascending-icon")),a._updateColumnHeaderCellElementWidth(o);for(let l=0;l<a._sortColumns.length;l++){const e=a._sortColumns[l];n.push(e.dataField),s.push(e.direction),d.push(e.dataType)}const p=function(){a.dataSource.sort(a.dataSource.boundSource,n,s,d);for(let e=0;e<a.dataSource.length;e++){const t=a.rows[e],l=a.dataSource[e];t.dataRow=l,t.boundIndex=l.boundIndex}a.refresh()};if(a.appearance.allowSortAnimation){let e=[],t=[];a._sortAnimation=!0;const o=function(){for(let t=0;t<a._rowElements.length;t++){const l=a._rowElements[t];l.classList.remove("smart-grid-sort-animation"),a.removeTransformMoveStyle(l),0<l.offsetHeight&&e.push(l.offsetTop)}};o(),setTimeout(function(){o(),a._sortAnimation=!1},a.appearance.sortAnimationDuration),setTimeout(function(){p()},a.appearance.sortAnimationDuration/2);for(let o=0;o<e.length;o++){const n=a._rowElements[o];n.classList.remove("smart-grid-sort-animation"),a.removeTransformMoveStyle(n);let s=l(Math.random()*e.length-1+1);for(;t[s];)s=l(Math.random()*e.length-1+1);t[s]=!0,a.addTransformMoveStyle(n,"0ms",0,-n.offsetTop+e[s],0,.5),n.classList.add("smart-grid-sort-animation"),setTimeout(function(){a.addTransformMoveStyle(n,a.appearance.sortAnimationDuration+"ms",0,0,0,1)}),setTimeout(function(){n.classList.remove("smart-grid-sort-animation")},a.appearance.sortAnimationDuration)}}else p()}_downHandler(e){const t=this;if(t._toggledRow&&t.appearance.allowRowToggleAnimation)return;const l=document.elementsFromPoint(e.pageX,e.pageY);let a=null,o=null,n=null;const s=function(){const e=t._scrollView.scrollLeft;t._refreshLayout(),t._recycle(),t._scrollView.scrollLeft=e};t._lastPointerDownTime=new Date;let d=null;for(let t=0;t<l.length;t++){const e=l[t];if(e.classList.contains("smart-arrow-down")&&(d=e),e.classList.contains("smart-arrow-right")&&(d=e),e.classList.contains("smart-arrow-left")&&(d=e),e.classList.contains("smart-grid-tree-column-cell")&&(n=!0),e.classList.contains("smart-grid-row-detail-cell")&&(o=!0),e.classList.contains("smart-grid-row-adaptive-detail-cell")&&(adaptiveToggleButton=!0),e.classList.contains("smart-grid-row")){a=e;break}}if(a){if(n&&d||0<t._adaptiveLayout&&!1===a.row.leaf){const e=a.row;t._toggleRow(e)}if(t.rowDetail.enabled&&t.rowDetail.visible&&o){const e=a.row;a.classList.add("animation"),e.detailExpanded=!e.detailExpanded,e.height=a.row.detailExpanded?e.cellHeight+e.detailHeight:e.cellHeight,(e.adaptiveDetailExpanded||t.adaptivityMode.responsiveLayout.autoShowHiddenCells&&e.adaptiveHeight)&&!e.label&&(e.height+=e.adaptiveHeight),s()}}}_focusHandler(){const e=this;e._focused=!0}_blurHandler(){const e=this;e._focused=!1}propertyChangedHandler(e,t,l){super.propertyChangedHandler(e,t,l);const a=this;switch(e){case"dataSource":{a.clearSelection(),a._dataBind();break}case"displayLoadingIndicator":{a._setLoadingIndicatorVisibility();break}case"filterable":{a._refreshLayout();break}case"selectionMode":{const e="checkBox"===a.selectionMode||"radioButton"===a.selectionMode?a.selectionMode:"default";0===a.selectedIndexes.length&&0<a.dataSource.length&&("oneOrMany"===a.selectionMode||"one"===a.selectionMode||"default"===a.selectionMode)&&a.select(a.dataSource[0]);const t=a.selectedValues;a.selectedValues=[],a._refreshSelection();for(let e=0;e<t.length;e++){const l=t[e],o=a.getRow(l);o&&("default"===a.selectionMode?a._select(o):a.select(o))}a.dataSource.forEach(t=>t.displayMode=e),a._recycle();break}}}clearSelection(){const e=this;e.dataSource&&0!==e.dataSource.length&&e._recycle()}ensureVisible(e){const t=this;return!("string"==typeof e&&(e=t.getRow(e),!e))&&(e.top+e.height>=t._scrollView.scrollTop+t._clientSize.height&&(t._scrollView.scrollTop+=e.height),(e.top<=t._scrollView.scrollTop||e.top>=t._scrollView.scrollTop+t.$.rowContainer.offsetHeight)&&(t._scrollView.scrollTop=e.top),0===t._indexOf(e)||1===t._indexOf(e)&&1<t.dataSource.length&&t.dataSource[0].grouped?t._scrollView.scrollTop=0:t._indexOf(e)===t.dataSource.length-1&&(t._scrollView.scrollTop=t._scrollView.scrollHeight),!0)}ready(){super.ready();const e=this,t=getComputedStyle(e);e._areCSSVarsSupported=Smart.Utilities.Core.CSSVariablesSupport(),e.isUpdating=0,e._scrollView=new Smart.Utilities.Scroll(e,e.$.horizontalScrollBar,e.$.verticalScrollBar),e._scrollView.hScrollBar.classList.add("smart-hidden"),e._scrollView.vScrollBar.classList.add("smart-hidden"),e.setFocusable(!0),e._setLoadingIndicatorVisibility(),e._overflowX=t.overflowX,e._overflowY=t.overflowY,e.classList.add("smart-element-ready"),e._dataBind()}_createCellElement(e,t){const l=this,a=document.createElement("div"),o=document.createElement("div");if(a.classList.add("smart-grid-cell"),a.appendChild(o),e.treeColumn&&l.dataSource.itemHierarchy){a.classList.add("smart-grid-tree-column-cell");const e=document.createElement("div"),l=document.createElement("div"),n=document.createElement("div");t.expanded?l.classList.add("smart-arrow-down"):l.classList.add("smart-arrow-right"),a.toggleArrow=l,o.appendChild(e),o.appendChild(l),o.appendChild(n)}return a}_createRowElement(e){const t=this,l=document.createElement("div"),a=document.createElement("div"),o=document.createElement("div"),n=document.createElement("div"),s=document.createDocumentFragment(),d=document.createDocumentFragment(),r=document.createDocumentFragment();l.classList.add("smart-grid-row"),o.classList.add("near","smart-grid-cell-container"),a.classList.add("center","smart-grid-cell-container"),n.classList.add("far","smart-grid-cell-container"),l.row=e;for(let l=0;l<t._fixedNearColumns.length;l++){const a=t._fixedNearColumns[l],o=t._createCellElement(a,e);d.appendChild(o)}for(let l=0;l<t._fixedFarColumns.length;l++){const a=t._fixedFarColumns[l],o=t._createCellElement(a,e);r.appendChild(o)}for(let a=0;a<t._columnElements.length;a++){const o=t._columnElements[a],n=o.column;if(!o.parentNode)break;const d=t._createCellElement(n,e);n.treeColumn&&(l.toggleArrow=d.toggleArrow),s.appendChild(d)}o.appendChild(d),a.appendChild(s),n.appendChild(r);const c=document.createElement("div");c.classList.add("smart-grid-row-detail","smart-hidden","smart-grid-row-adaptive-detail");const h=document.createElement("div");h.classList.add("smart-grid-row-detail","smart-hidden");const m=document.createElement("div");return m.classList.add("smart-grid-row-sub-container","smart-hidden"),0<t._adaptiveLayout&&(o.classList.add("smart-visibility-hidden"),a.classList.add("smart-visibility-hidden"),n.classList.add("smart-visibility-hidden")),l.detail=h,l.adaptiveDetail=c,l.rowContainer=m,l.cellsNearContainerElement=o,l.cellsContainerElement=a,l.cellsFarContainerElement=n,l.appendChild(o),l.appendChild(a),l.appendChild(n),l.appendChild(c),l.appendChild(h),l.appendChild(m),l.cells=Array.from(o.children).concat(Array.from(a.children)).concat(Array.from(n.children)),t.rowHeight&&"auto"!==t.rowHeight&&(l.style.height=t.rowHeight+"px"),l}_beginUpdate(){const e=this;e.isUpdating++}_isUpdating(){const e=this;return 0<e.isUpdating}_endUpdate(){const e=this;e.isUpdating--}get _scrollHeight(){var e=Math.ceil;const t=this,l=t.rowHierarchy?t.rowHierarchy:t.rows,a=t._createRowElement(l[0]);let o=0,n=t.rowMinHeight,s=0;if(t.__scrollHeight)return t.__scrollHeight;if(0===l.length||0===t.columns.length)return 0;t.isUpdating++,t.$.scrollView.appendChild(a),t._renderRowElement(a,l[0]);let d=0,r=0;if(t._responsiveLayout)for(let e=0;e<t._columns.length;e++){const l=t._columns[e];l.autoGenerated||(l.adaptiveVisible?d++:r++)}else if(0<t._adaptiveLayout)for(let e=0;e<t._columns.length;e++){const l=t._columns[e];l.autoGenerated||d++}for(let e=0;e<a.children[1].children.length;e++){a.children[1].children[e].style.height="auto",n=Math.max(t.rowMinHeight,a.children[1].children[e].offsetHeight);break}t._measuredHeight=n;const c=2===t._adaptiveLayout?"50%":1===t._adaptiveLayout?"100%":0;for(let a=0;a<l.length;a++){const h=l[a];if(!h.visible){h.height=0,h.top=o;continue}let m=!h.height||!h.cellHeight||c||h.adaptiveHeight||t._responsiveLayout;if(m&&!h.expandHeight)if(h.detailHeight||(h.detailHeight=200),h.adaptiveDetailHeight||(h.adaptiveDetailHeight=200),!t.rowHeight){if(h.height=n,h.adaptiveHeight=0,c){const t="50%"===c?e(d/2):d;h.adaptiveHeight=h.label?h.height:2*t*n}if(h.cellHeight=h.height,t._responsiveLayout){const t=e(d/r);h.adaptiveHeight=h.label?h.height:t*n,h.adaptiveHeight+=50}t.rowDetail.enabled&&h.detailExpanded&&(h.height+=h.detailHeight),c&&0<t._adaptiveLayout?h.height=h.adaptiveHeight:t._responsiveLayout&&(t.adaptivityMode.responsiveLayout.autoShowHiddenCells||h.adaptiveDetailExpanded)&&!h.label&&(h.height+=h.adaptiveHeight)}else t.rowHeight&&("number"==typeof t.rowHeight?(t.rowHeight<t.rowMinHeight&&(t.rowHeight=t.rowMinHeight),h.height=t.rowHeight,h.cellHeight=h.height,t.rowDetail.enabled&&h.detailExpanded&&(h.height+=h.detailHeight)):(t.rowHeight(a,h),h.height||(h.height=n),h.cellHeight=h.height,t.rowDetail.enabled&&h.detailExpanded&&(h.height+=h.detailHeight)));h.fixed&&"near"===h.fixPosition&&(s+=h.height),h.top=o,o+=h.expandHeight?h.cellHeight:h.height}return t.$.scrollView.removeChild(a),t.__scrollHeight=o,t.__fixedNearHeight=s,t._scrollView.scrollHeight=o-t.$.scrollView.offsetHeight+s,o=t.__scrollHeight,t.isUpdating--,o}_initializeColumnGroupsHierarchy(){const e=this;let t=0;e.$.columnContainerElement.innerHTML="";const l=function(){const t=document.createElement("div"),l=document.createElement("div");let a=0;return t.classList.add("smart-grid-column-header-cell"),l.classList.add("smart-label"),l.innerHTML="aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRwWxXyYzZ1234567890",t.appendChild(l),t.style.height="auto",t.style.position="static",e.$.columnHeader.appendChild(t),a=e.$.columnHeader.offsetHeight,e.$.columnHeader.removeChild(t),a};if(e._columnsHeight=l(),0<e.columnGroups.length){e._columnsHierarchy=[];for(let t=0;t<e.columnGroups.length;t++)e.columnGroups[t].parent=null,e.columnGroups[t].groups=null;for(let t=0;t<e._columns.length;t++)e._columns[t].parent=null,e._columns[t].groups=null;const l=function(t){for(let l,a=0;a<e.columnGroups.length;a++)if(l=e.columnGroups[a],l.name===t)return l;return null},a=function(e){let t=[];if(e.columnGroup&&t.push(e),e.groups)for(let l=0;l<e.groups.length;l++)if(e.groups[l].columnGroup)t.push(e.groups[l]);else if(e.groups[l].groups){let o=a(e.groups[l]);for(let e=0;e<o.length;e++)t.push(o[e])}return t};for(let t,a=0;a<e.columnGroups.length;a++)if(t=e.columnGroups[a],t.groups||(t.groups=null),t.parentGroup){let e=l(t.parentGroup);e&&(t.parent=e,!e.groups&&(e.groups=[]),-1===e.groups.indexOf(t)&&e.groups.push(t))}for(let t,a=0;a<e._columns.length;a++)if(t=e._columns[a],t.columnGroup){let e=l(t.columnGroup);e&&(!e.groups&&(e.groups=[]),t.parent=e,-1===e.groups.indexOf(t)&&e.groups.push(t))}for(let l=0;l<e._columns.length;l++){const a=e._columns[l];let o=a;for(a.level=0;o.parent;)o=o.parent,a.level++;o=a;let n=a.level;for(t=Math.max(t,a.level);o.parent;)o=o.parent,o&&(o.level=--n)}for(let t=0;t<e.columnGroups.length;t++){const l=e.columnGroups[t],o=a(l);l.columns=o;let n=[],s=0,d="near";for(let t=0;t<o.length;t++)n.push(e._columns.indexOf(o[t])),o[t].fixed&&("far"===o[t].fixPosition&&(d="far"),s++);s===o.length?(l.fixed=!0,l.fixPosition=d):0<s&&s<o.length&&e.error(e.localize("fixedColumns",{elementType:e.nodeName.toLowerCase()})),n.sort(function(e,t){return e=parseInt(e),t=parseInt(t),e<t?-1:e>t?1:0});for(let t=1;t<n.length;t++)n[t]!==n[t-1]+1&&e.error(e.localize("columnGroups",{elementType:e.nodeName.toLowerCase()}))}}e._columnGroupsLevel=1+t,e._columnHeaderHeight=e._columnGroupsLevel*e._columnsHeight,e._columnHeights=[];let a=0;for(let t,l=0;l<e._columnGroupsLevel;l++)t=e._columnsHeight,e.columnHeight&&("number"==typeof e.columnHeight?t=e.columnHeight?e.columnHeight:e._columnsHeight:t=e.columnHeight?e.columnHeight(l):e._columnsHeight),t?(e._columnHeights.push(t),a+=t):(a+=e._columnsHeight,e._columnHeights.push(e._columnsHeight));e._columnHeaderHeight=a,e.$.columnHeader.style.height=e._columnHeaderHeight+"px"}_createColumnHeaderCellElement(e){const t=document.createElement("div"),l=document.createElement("div"),a=document.createElement("div"),o=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div");return t.classList.add("smart-grid-column-header-cell","smart-hidden"),l.classList.add("smart-label"),l.innerHTML=e.label,a.classList.add("sort-icon-container","smart-hidden"),o.classList.add("filter-icon-container","smart-hidden"),n.classList.add("action-icon-container","smart-hidden"),s.classList.add("icon-container"),t.style.width=e.computedWidth+"px",t.appendChild(l),t.appendChild(s),s.appendChild(a),s.appendChild(o),s.appendChild(n),t.column=e,t.labelElement=l,t.sortIconContainerElement=a,t.filterIconContainerElement=o,t.actionIconContainerElement=n,t.iconContainerElement=s,t}_initializeColumnHeaderBounds(){const e=this;let t=0<e.$.verticalScrollBar.offsetWidth?e.$.verticalScrollBar.offsetWidth-1:0;const l=e._clientSize.width-t,a=e.adaptivityMode.adaptiveLayout.width,o=e.adaptivityMode.responsiveLayout.width,n=e.adaptivityMode.adaptiveLayout.enabled&&l<=a?l>=375?"50%":"100%":null;e._adaptiveLayout=0,n&&("50%"===n?e._adaptiveLayout=2:e._adaptiveLayout=1);let s=0,d=[],r=0,c=0;const h=function(t){let l=0;for(let a=0;a<t.level;a++)l+=e._columnHeights[a];return l};e._responsiveLayout=!1;const m=e._columns.concat(e.columnGroups),u=function(t){let l=h(t),a=e._columnHeaderHeight-l;for(let l=t.level+1;l<e._columnHeights.length;l++){const o=l;for(let l=0;l<m.length;l++){const n=m[l];let s=!1;if(n.level===o){for(let l=n;l.parent;){if(l.parent===t){a-=e._columnHeights[o],s=!0;break}l=l.parent}if(s)break}}}return a};for(let t=e._columns.length-1;0<=t;t--){const a=e._columns[t];if(a.adaptiveVisible){e._responsiveLayout=e.adaptivityMode.responsiveLayout.enabled&&l<=o&&0===e._adaptiveLayout;break}}for(let t=0;t<e._columns.length;t++){const a=e._columns[t];let o;const r=u(a);if(a.computedHeight=r,a.top=h(a),n){o=parseFloat(n)/100,o*=l,a.computedWidth=o;continue}"number"==typeof a.width?o=a.width:a.width&&0<=a.width.toString().indexOf("%")?(o=parseFloat(a.width)/100,o*=l):(d.push(a),o=0),a.overflowWidth&&(o-=a.overflowWidth),a.visible&&!a.adaptiveVisible&&(s+=o),o<a.minWidth&&(o=a.minWidth),a.computedWidth=o}if(d){let e=l-s-1,t=0;0>e&&(e=60*d.length);for(let l=0;l<d.length;l++){const a=d[l];let o;o=e/d.length,l==d.length-1&&(o=e-t),a.overflowWidth&&(o-=a.overflowWidth),o<a.minWidth&&(o=a.minWidth),a.computedWidth=o,t+=o}}let p=0;for(let t=0;t<e._columns.length;t++){const l=e._columns[t];l.visible&&!l.adaptiveVisible&&(l.fixed?"near"===l.fixPosition?(l.left=r,p+=l.computedWidth,r+=l.computedWidth):"far"===l.fixPosition&&(l.left=c,c+=l.computedWidth):(l.left=p,p+=l.computedWidth))}for(let t=0;t<e._columnGroupsLevel-1;t++)for(let l=0;l<e.columnGroups.length;l++){const a=e.columnGroups[l],o=a.level;if(o!==t)continue;const n=h(a);let s=99999;if(a.groups){const e=function(t){let l=0;for(let a,o=0;o<t.groups.length;o++)a=t.groups[o],a.groups?l+=e(a):!a.hidden&&(s=Math.min(a.left,s),l+=a.computedWidth);return l},t=u(a);a.computedWidth=e(a),a.left=s,a.top=n,a.computedHeight=t}}}_initializeColumnHeaderCellElements(){const e=this,t=e.$.columnContainerElement,l=document.createDocumentFragment();let a=0,o=0,n=0,s=0;e._columnElements=[],e.$.columnContainerElement.innerHTML="",e.$.columnNearContainerElement.innerHTML="",e.$.columnFarContainerElement.innerHTML="",e._initializeColumnHeaderResponsiveBounds();for(let t=0;t<e._columns.length;t++){const l=e._columns[t];l.visible&&!l.adaptiveVisible&&(s+=l.computedWidth,l.fixed?"near"===l.fixPosition?(a+=l.computedWidth,n+=l.computedWidth):"far"===l.fixPosition&&(o+=l.computedWidth):n+=l.computedWidth)}n=0;for(let t=0;t<e._fixedNearColumns.length;t++){const l=e._fixedNearColumns[t],a=e._createColumnHeaderCellElement(l);l.headerCellElement=a,e._renderColumnHeaderCellElement(a,l)}for(let t=0;t<e._fixedFarColumns.length;t++){const l=e._fixedFarColumns[t],a=e._createColumnHeaderCellElement(l);l.headerCellElement=a,e._renderColumnHeaderCellElement(a,l)}for(let t=0;t<e._columns.length;t++){const a=e._columns[t];if(a.fixed)continue;const o=e._createColumnHeaderCellElement(a);a.headerCellElement=o,n+=a.computedWidth,e._columnElements.push(o),n<2*e._clientSize.width&&l.appendChild(o)}for(let t=0;t<e.columnGroups.length;t++){const a=e.columnGroups[t],o=document.createElement("div"),n=document.createElement("div");o.classList.add("smart-grid-column-header-cell"),o.classList.add("smart-grid-column-header-group-cell"),n.classList.add("smart-label"),n.innerHTML=a.label,o.style.width=a.computedWidth+"px",o.style.left=a.left+"px",o.style.top=a.top+"px",o.style.height=a.computedHeight+"px",o.style.lineHeight=a.computedHeight+"px",o.appendChild(n),l.appendChild(o),a.headerCellElement=o}e.htmlColumnLastChild||(e.htmlColumnLastChild=document.createElement("div"),e.htmlColumnLastChild.classList.add("smart-grid-column-header-cell","top-corner"),e.$.columnHeader.appendChild(e.htmlColumnLastChild)),t.appendChild(l),n<e._clientSize.width&&(n=e._clientSize.width),t.style.width=s+"px",e.$.columnNearContainerElement.style.width=a+"px",e.$.columnFarContainerElement.style.width=o+"px";for(let t=0;t<e.columnGroups.length;t++){const l=e.columnGroups[t];l.fixed&&("near"===l.fixPosition?e.$.columnNearContainerElement.appendChild(l.headerCellElement):"far"===l.fixPosition&&e.$.columnFarContainerElement.appendChild(l.headerCellElement))}for(let t=0;t<e._columns.length;t++){const l=e._columns[t];l.fixed&&("near"===l.fixPosition?e.$.columnNearContainerElement.appendChild(l.headerCellElement):"far"===l.fixPosition&&e.$.columnFarContainerElement.appendChild(l.headerCellElement))}}get _clientSize(){const e=this,t=getComputedStyle(e.$.container),l=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),a=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),o=parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth),n=parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth);return{width:e.$.container.offsetWidth-l-o,height:e.$.container.offsetHeight-a-n}}_initializeRowElements(){const e=this;if(!e.rows||e.rows&&0===e.rows.length)return;let t=0,l=e._clientSize.height;e.$.rowContainer.innerHTML="",e._rowElements=[],e._overflowOffset=Math.max(l,300);const a=function(){for(let a=0;a<e.rows.length;a++){const o=e.rows[a];if(o.fixed)continue;const n=e._createRowElement(o);if(o.rowElement=n,e.$.rowContainer.appendChild(n),t+=e.rowMinHeight,e._rowElements.push(n),t>e._overflowOffset+l)break}};for(let t=0;t<e._fixedNearRows.length;t++){const l=e._fixedNearRows[t],a=e._createRowElement(l);l.rowElement=a,e.$.rowNearContainer.appendChild(a)}for(let t=0;t<e._fixedFarRows.length;t++){const l=e._fixedFarRows[t],a=e._createRowElement(l);l.rowElement=a,e.$.rowFarContainer.appendChild(a)}a();for(let e=0;t<1.5*l&&5>++e;)a()}_initializeRow(e,t){if(e){const l=this;void 0===e.detailExpanded&&(e.detailExpanded=!1),void 0===e.boundIndex&&(e.boundIndex=t),void 0===e.visibleIndex&&(e.visibleIndex=t),void 0===e.fixed&&(e.fixed=!1),void 0===e.fixPosition&&(e.fixPosition="near"),void 0===e.height&&(e.height=l.rowHeight||l._measuredHeight||l.rowMinHeight),void 0===e.minHeight&&(e.minHeight=l.rowMinHeight),void 0===e.selected&&(e.selected=!1),void 0===e.readonly&&(e.readonly=!1),void 0===e.enabled&&(e.enabled=!0),void 0===e.visible&&(e.visible=!0),void 0===e.allowResize&&(e.allowResize=!0),void 0===e.allowToggle&&(e.allowToggle=!0),void 0===e.expanded&&(e.expanded=!1),void 0===e.cssClass&&(e.cssClass=""),void 0===e.font&&(e.font=null),void 0===e.color&&(e.color=null),void 0===e.horizontalAlign&&(e.horizontalAlign=null),void 0===e.verticalAlign&&(e.verticalAlign=null),void 0===e.background&&(e.background=null),void 0===e.template&&(e.template=null),e.headerCell=null,e.cells=[],l.onInitNewRow&&l.onInitNewRow(t,e)}}_initializeRows(){const e=this;let t=0;e.rows=[],e.rowById=[],e._fixedFarRows=[],e._fixedNearRows=[];const l=function(){let t=[];for(let l=0;l<e.columns.length;l++){const a=e.columns[l];let o={};o[a.dataField]=a.summary,t.push(o)}e._summaryItems=e.dataSource.summarize(t)},a=function(l,a){const o=new GridRow;o.dataRow=l,e._initializeRow(o,a),e.rowById[o.uid]=o,o.fixed?"near"===o.fixPosition?(e.rows.splice(t++,0,o),e._fixedNearRows.push(o)):"far"===o.fixPosition&&(e._fixedFarRows.push(o),e.rows.push(o)):e.rows.push(o)},o=function(){const t=e.rows[e.rows.length-1];delete e.rowById[t.uid],e.rows.pop()},n=function(t){delete e.rowById[lastRow.uid],e.rows.splice(t,1)};for(let t=0;t<e.dataSource.length;t++){const l=e.dataSource[t];a(l,t)}if(l(),e.dataSource.onChanged=function(t){if(!e.dataSource._updating){const s=t.data;switch(t.type){case"add":if(s.length)for(let t=0;t<s.length;t++)a(s,e.dataSource.length-s.length+t);else a(s,e.dataSource.length-1);break;case"insert":a(s,detail.index);for(let t=0;t<e.rows.length;t++){const l=e.rows[t];l.dataIndex=t}break;case"remove":n(t.index);break;case"removeLast":o();}l(),e._refreshLayout(),e._recycle()}},e.rows=e.rows.concat(e._fixedFarRows),e.newRow.visible){const t={fixed:!0,fixPosition:"near",visible:"near"===e.newRow.position,newRow:!0};e._initializeRow(t,-1),e._fixedNearRows.splice(0,0,t);const l={fixed:!0,fixPosition:"far",visible:"far"===e.newRow.position,newRow:!0};e._initializeRow(l,-1),e._fixedFarRows.push(l)}if(e.summaryRow.visible)for(let t=0;t<e._summaryRowCount;t++){const l={fixed:!0,fixPosition:"near",visible:"near"===e.summaryRow.position,summaryRowIndex:t,summaryRow:!0};e._initializeRow(l,-1),e._fixedNearRows.splice(0,0,l);const a={fixed:!0,fixPosition:"far",visible:"far"===e.summaryRow.position,summaryRowIndex:t,summaryRow:!0};e._initializeRow(a,-1),e._fixedFarRows.push(a)}if(e.filter.filterRow.visible){const t={fixed:!0,fixPosition:"near",filterRow:!0};e._initializeRow(t,-1),e._fixedNearRows.splice(0,0,t)}}_dataBind(){const e=this;if(null!==e.dataSource){e.isUpdating++;const t=e.$.verticalScrollBar.offsetWidth;e._initializeColumns(),e._initializeColumnGroupsHierarchy(),e._initializeColumnHeaderCellElements(),e._initializeRows(),e._initializeRowElements(),e._renderColumnGroupHeaders(),e._refreshLayout(),t!==e.$.verticalScrollBar.offsetWidth&&e._initializeColumnHeaderResponsiveBounds(),e._recycle(),e._initializeSpecialCells(),e.isInitialized=!0,e.isUpdating--;for(let t=0;t<e._columns.length;t++){const l=e._columns[t];if(!l.allowSort||!l.sortOrder)continue;const a=e.appearance.allowSortAnimation;e.appearance.allowSortAnimation=!1,e.sort(l.dataField,l.sortOrder),e.appearance.allowSortAnimation=a}}}_initializeColumns(){const e=this;let t=0;if(e.columnByDataField=[],e._columns=[],e._boundColumns=Array.isArray(e.columns)?e.columns.splice(0):e.columns.toArray().splice(0),e.columns=new Smart.ObservableArray,e._fixedFarColumns=[],e._fixedNearColumns=[],e._summaryRowCount=0,0===e._boundColumns.length&&e.dataSource&&e.dataSource[0]){const t=e.dataSource[0];for(let l in t){if(l.startsWith("_"))continue;const t={label:l,dataField:l};if(e.dataSource.dataFields){const a=e.dataSource.dataFields.find(e=>{if(e.name===l)return e});t.dataType=a.dataType||"string"}e._boundColumns.push(t),e.columnByDataField[t.dataField]=t}}for(let l,a=0;a<e._boundColumns.length;a++){if(l=e._boundColumns[a],"string"==typeof l&&e.dataSource.dataFields){const t=e.dataSource.dataFields.find(e=>{if(e.name===l)return e});l={label:l,dataField:l,dataType:t.dataType||"string"}}const o=new GridColumn(l);o.index=a,o.visibleIndex=a,e.columns.push(o),0==a&&(o.treeColumn=!0),e._summaryRowCount=Math.max(e._summaryRowCount,o.summary.length),o.fixed?"near"===o.fixPosition?(e._columns.splice(t++,0,o),e._fixedNearColumns.push(o)):"far"===o.fixPosition&&e._fixedFarColumns.push(o):e._columns.push(o),e.columnByDataField[o.dataField]=o}if(e._columns=e._columns.concat(e._fixedFarColumns),e.appearance.showRowNumber){const t=function(){const t=document.createElement("div"),l=document.createElement("div");let a=0;return t.classList.add("smart-grid-column-header-cell"),l.classList.add("smart-label"),l.innerHTML="<span>"+e.rows.length+"</span>",t.appendChild(l),t.style.width="auto",t.style.position="static",e.$.columnHeader.appendChild(t),a=20+l.firstChild.offsetWidth,e.$.columnHeader.removeChild(t),a}(),l={label:"",fixed:!0,visible:!0,fixPosition:"near",autoGenerated:!0,rowNumbersColumn:!0,cellsAlign:"center",width:t};e._columns.splice(0,0,l),e._fixedNearColumns.splice(0,0,l)}if(e.rowDetail.enabled){const t={label:"",fixed:!0,fixPosition:"near",toggleColumn:!0,autoGenerated:!0,cellsAlign:"center",width:25};t.visible=e.rowDetail.visible,e._columns.splice(0,0,t),e._fixedNearColumns.splice(0,0,t)}const l={label:"",fixed:!0,fixPosition:"far",adaptiveColumn:!0,autoGenerated:!0,cellsAlign:"center",width:25};l.visible=!e.adaptivityMode.responsiveLayout.autoShowHiddenCells,e._columns.push(l),e._fixedFarColumns.splice(0,0,l),e._observeColumns()}_observeColumns(){const e=this;for(let t=0;t<e.columns.length;t++){const l=e.columns[t];l.propertyChanged=function(t,a,o){if("sortOrder"!==t){if("fixed"===t)if(!!o)l.fixed&&("near"===l.fixPosition?e._fixedNearColumns.push(l):e._fixedFarColumns.push(l));else if("near"===l.fixPosition){const t=e._fixedNearColumns.indexOf(l);0<=t&&e._fixedNearColumns.splice(t,0,0)}else{const t=e._fixedFarColumns.indexOf(l);0<=t&&e._fixedFarColumns.splice(t,0,0)}e.refresh()}}}e.columns.observe(function(t){if(e.columns.isUpdating)return;if(!t.item||t.path)return;e.columns.isUpdating=!0;const l=t.type,a=new GridColumn(t.item);let o=0;switch(l){case"add":for(let t=e._columns.length-1;0<=t&&!e._columns[t].dataField;t--)o++;e._columns.splice(e._columns.length-o,0,a),a.fixed&&("near"===a.fixPosition?e._fixedNearColumns.push(a):e._fixedFarColumns.push(a)),e.columnByDataField[a.dataField]=a,e.columns[t.index]=a;break;case"update":for(let t=0;t<n;t++)e._columns[t].dataField||o++;e._columns[o+n]=a,e.columnByDataField[a.dataField]=a,e.columns[t.index]=a;break;case"delete":let n=t.index;for(let t=0;t<n;t++)e._columns[t].dataField||o++;e._columns.splice(n,1),delete e.columnByDataField[a.dataField],delete e.columns[t.index];}e._initializeColumnGroupsHierarchy(),e._initializeColumnHeaderCellElements(),e.refresh(),e.columns.isUpdating=!1})}_initializeSpecialCells(){const e=this;if(0<e.specialCells.length){for(let t=0;t<e.specialCells.length;t++){const l=e.specialCells[t],a=document.createElement("div");l.cellElement=a,a.classList.add("smart-grid-cell"),a.classList.add("smart-grid-cell-special");const o=document.createElement("div");o.classList.add("smart-label");let n=0,s=-1;for(let t=0;t<e._columns.length;t++){const d=e._columns[t];if(-1!==s&&t<s+l.columnSpan&&(n+=d.computedWidth),d.dataField===l.dataField){switch(n+=d.computedWidth,l.left=d.left,s=t,l.align||d.cellsAlign){case"left":o.classList.add("align-left");break;case"center":o.classList.add("align-center");break;case"right":o.classList.add("align-right");}l.column=d}l.classList&&a.classList.add(l.classList)}a.classList.add("smart-hidden"),l.width=n;const d=e.rows["uid_"+l.rowId],r=e.rows.indexOf(d),c=d[l.dataField];o.innerHTML=c,a.appendChild(o),l.top=d.top,l.height=d.height;let h=d.fixed?1:0;for(let t=1;t<l.rowSpan;t++){const a=e.rows[r+t];a.fixed&&h++,l.height+=a.height}0<h&&h<l.rowSpan?e.error(e.localize("fixedRows",{elementType:e.nodeName.toLowerCase()})):h===l.rowSpan&&0<h&&(l.fixedRows=!0,a.classList.add("smart-grid-cell-fixed")),a.style.width=l.width+"px",a.style.height=l.height+"px",a.style.top=l.top+"px",a.style.left=l.left+"px",e.$.specialCellsContainer.appendChild(a)}e._recycle()}}get _scrollWidth(){const e=this;if(e.__scrollWidth)return e.__scrollWidth;let t=0;for(let l=0;l<e._columns.length;l++){const a=e._columns[l];a.visible&&!a.adaptiveVisible&&(t+=a.computedWidth)}if(e.adaptivityMode.responsiveLayout.enabled){const t=e.adaptivityMode.responsiveLayout.width,l=1+e.$.scrollView.offsetWidth;if(l<=t)return 0}if(e.adaptivityMode.adaptiveLayout.enabled){const t=e.adaptivityMode.adaptiveLayout.width,l=1+e.$.scrollView.offsetWidth;if(l<=t)return 0}return e.__scrollWidth=t,e._scrollView.scrollWidth=t-e._clientSize.width,e.__scrollWidth}_select(e,t){const l=this,a=l.selectedIndexes.indexOf(l._indexOf(e)),o=l.selectedIndexes.slice(0),n=l.selectedValues.slice(0);if(e.selected=!0,-1===a)o.push(l._indexOf(e)),n.push(e.value||e.label);else return l._recycle(),!1;return(l.selectedIndexes=o,l.selectedValues=n,l._recycle(),l.isCompleted&&!t&&l.isInitialized)?(l.$.fireEvent("change",{selected:e.selected,disabled:e.disabled,index:l._indexOf(e),label:e.label,value:e.value}),!0):void 0}unselect(e){const t=this;if(!e)return;if("string"==typeof e&&(e=t.getRow(e),!e))return;if("none"===t.selectionMode)return void t.clearSelection();const l=t.selectedIndexes.indexOf(t._indexOf(e)),a=t.selectedIndexes.slice(0),o=t.selectedValues.slice(0);if(e.selected=!1,0<=l)a.splice(l,1),o.splice(l,1);else return!1;return(t.selectedIndexes=a,t.selectedValues=o,!!t.isCompleted)?(t.$.fireEvent("change",{selected:e.selected,disabled:e.disabled,index:t._indexOf(e),label:e.label,value:e.value}),t._recycle(),!0):void 0}_horizontalScrollbarHandler(e){const t=this;e.stopPropagation(),t._recycle()}_focus(e){const t=this;!e||"none"===t.selectionMode||t.disabled||t.readonly||(t._focusedRow&&(t._focusedRow.focused=!1),t._focusedRow=e,t._focusedRow.focused=!0)}_keyDownHandler(){}_mouseWheelHandler(e){const t=this;t._scrollView.hScrollBar.$.hasClass("smart-hidden")&&t._scrollView.vScrollBar.$.hasClass("smart-hidden")||!t.disabled&&!t._scrollView.vScrollBar.$.hasClass("smart-hidden")&&(e.stopPropagation(),e.preventDefault(),t._scrollView.scrollTo(t._scrollView.scrollTop+(0>e.deltaY?-t._clientSize.height:t._clientSize.height)))}clearRows(){const e=this;e.dataSource=[],e.clearSelection()}refresh(){const e=this;e._initializeColumnHeaderResponsiveBounds(),e._refreshLayout(),e._recycle()}_resizeHandler(e){const t=this;e.target!==t||t._isUpdatingScrollBars||(t._isUpdatingScrollBars=!0,t.refresh(),t._isUpdatingScrollBars=!1)}_initializeColumnHeaderResponsiveBounds(){const e=this,t=e.adaptivityMode.responsiveLayout.width,l=e.adaptivityMode.adaptiveLayout.width,a=1+e.$.scrollView.offsetWidth,o=e.$.columnContainerElement,n=e.$.columnNearContainerElement,s=e.$.columnFarContainerElement,d=e.adaptivityMode.responsiveLayout.enabled&&!e.adaptivityMode.responsiveLayout.autoShowHiddenCells;let r=0,c=0,h=0;for(let t=0;t<e._columns.length;t++){const l=e._columns[t];l.overflowWidth=void 0,l.adaptiveVisible=!1}d&&(e.adaptivityMode.responsiveLayout.enabled?a>t&&(e._columns[e._columns.length-1].adaptiveVisible=!0):!e.adaptivityMode.adaptiveLayout.enabled&&(e._columns[e._columns.length-1].adaptiveVisible=!0)),e._initializeColumnHeaderBounds();for(let t=0;t<e._columns.length;t++){const l=e._columns[t];l.visible&&!l.adaptiveVisible&&(l.fixed&&("near"===l.fixPosition?r+=l.computedWidth:"far"===l.fixPosition&&(c+=l.computedWidth)),h+=l.computedWidth)}if(o.style.width=h+"px",n.style.width=r+"px",s.style.width=c+"px",s.classList.remove("smart-hidden"),n.classList.remove("smart-hidden"),0===c&&s.classList.add("smart-hidden"),0===r&&n.classList.add("smart-hidden"),e.adaptivityMode.responsiveLayout.enabled||e.adaptivityMode.adaptiveLayout.enabled){const o=a<=t&&e.adaptivityMode.responsiveLayout.enabled,n=a<=l&&e.adaptivityMode.adaptiveLayout.enabled;if(o||n){for(let t=e._columns.length-1;0<=t;t--){const l=e._columns[t];if(l.visible&&!l.fixed){if(h-l.computedWidth<=a)break;h-=l.computedWidth,l.adaptiveVisible=!0}}if(h>a){let t=h-a,l=-1;const o=function(t){for(let a=e._columns.length-1;0<=a;a--){const o=e._columns[a];if(!o.visible||o.fixed)continue;if(o.adaptiveVisible)continue;-1===l&&(l=a);const n=o.computedWidth-t;if(n<o.minWidth){const e=o.computedWidth-o.minWidth;o.overflowWidth=e,t-=e}else return o.overflowWidth=t,0}return t};if(t=o(t),0<t&&-1!==l){const n=e._columns[l];h-=n.computedWidth,n.adaptiveVisible=!0,t=h-a,o(t)}e._initializeColumnHeaderBounds(),h=a}}}}_selectStartHandler(e){e.preventDefault()}setFocusable(e){const t=this;return t.disabled||!e?void t.removeAttribute("tabindex"):void(t.tabIndex=0)}_setLoadingIndicatorVisibility(){const e=this;return e.displayLoadingIndicator?void(e.$loadingIndicatorContainer.hasClass("smart-visibility-hidden")?e.$.loadingIndicatorContainer.classList.remove("smart-visibility-hidden"):e.$.loadingIndicatorContainer.classList.remove("smart-hidden")):void(e._areCSSVarsSupported?e.$.loadingIndicatorContainer.classList.add("smart-hidden"):e.$.loadingIndicatorContainer.classList.add("smart-visibility-hidden"))}_refreshElementsVisibility(){const e=this,t=function(e,t){t?e.classList.remove("smart-hidden"):e.classList.add("smart-hidden")};if(t(e.$.footer,e.footer.visible),t(e.$.header,e.header.visible),t(e.$.groupHeader,e.groupHeader.visible),t(e.$.columnHeader,e.columnHeader.visible&&!e._adaptiveLayout),t(e.$.filterFooter,e.filter.filterFooter.visible),e.pager&&e.pager.visible)switch(e.pager.position){case"near":t(e.$.headerPager,!0);break;case"far":t(e.$.footerPager,!0);}else t(e.$.footerPager,!1),t(e.$.headerPager,!1);e._refreshRowHierarchy()}_refreshRowHierarchy(){const e=this;if(e.dataSource.itemHierarchy){const t=e.dataSource.reservedNames,l=function(t){const l=Object.assign({},t);return l.dataRow=t,e._initializeRow(l,e.rows.length),e.rowById[t.uid]=l,l},a=function(o,n){for(let s=0;s<o.length;s++){const d=o[s];let r=e.rowById[d.uid];r||(r=l(d)),r.leaf=d[t.leaf],r.level=d[t.level],r.groupDataField=d.groupDataField,(null===e._toggledRow||e._toggledRow&&e._toggledRow.uid!==r.uid)&&(r.expandHeight=0),d.parent?(r.parent=e.rowById[d.parent.uid],r.parentId=d.parent.uid):(r.parent=null,r.parentId=null);const c=r.expanded;if(!0===r.visible)if(!(c||d[t.leaf]))n.push(r);else if(n.push(r),d.boundSource&&0<d.boundSource.length){const e=a(d.boundSource,[]);for(let l=0;l<e.length;l++)n.push(e[l])}}return n};if(e.rowHierarchy=a(e.dataSource.itemHierarchy,[]),e.hierarchySummaryRow.visible){const t=function(e,a,o,n){if(0!==e&&0<a.length&&a[a.length-1]&&!a[a.length-1].summaryRow){let t={summaryRow:!0,leaf:!0,level:e,expandHeight:0,siblings:a};o&&(t.parentId=o.uid,t.parent=o),t.uid="SubRow"+n+"_"+o.uid,t=l(t),a.push(t)}for(let l=0;l<a.length;l++)a[l]&&a[l].boundSource&&t(e+1,a[l].boundSource,a[l],l)};t(0,e.rowHierarchy,null,0)}}}_refreshContentHeight(){const e=this;let t=e._clientSize.height;("auto"===e.style.height||"visible"===e._overflowY||"hidden"===e._overflowY)&&(t=e._scrollHeight-1+e.$.columnHeader.offsetHeight+e.$.filterFooter.offsetHeight),e.header.visible&&(t-=e.$.header.offsetHeight),e.groupHeader.visible&&(t-=e.$.groupHeader.offsetHeight),e.footer.visible&&(t-=e.$.footer.offsetHeight),e.pageable&&(t-=e.$.headerPager.offsetHeight,t-=e.$.footerPager.offsetHeight),e.$.content.style.height=t+"px"}_refreshLayout(){const e=this,t=e.rows,l=e._scrollView.vScrollBar,a=e._scrollView.hScrollBar;if(e.__scrollHeight=null,e.__scrollWidth=null,e.$.placeholder.classList.add("smart-hidden"),a.classList.add("smart-hidden"),l.classList.add("smart-hidden"),l.classList.remove("bottom-corner"),a.classList.remove("bottom-corner"),e.$.columnFarContainerElement.classList.remove("vscroll"),e.$.scrollView.classList.remove("hscroll"),e.$.scrollView.classList.remove("vscroll"),e.htmlColumnLastChild.classList.add("smart-visibility-hidden"),e._refreshElementsVisibility(),e._refreshContentHeight(),!t||null===t||0===t.length)return void e.$.placeholder.classList.remove("smart-hidden");e.$.scrollView.style.height=e.$.content.offsetHeight-e.$.filterFooter.offsetHeight-e.$.columnHeader.offsetHeight+"px",e.htmlColumnLastChild.style.height=e.$.columnHeader.offsetHeight+"px";const o=e._scrollWidth-e.$.scrollView.offsetWidth-1,n=e._scrollHeight-e.$.scrollView.offsetHeight;0<o&&(a.classList.remove("smart-hidden"),e._scrollView.scrollHeight+=a.offsetHeight),l.style.top=e.$.scrollView.offsetTop+"px",l.style.height=e.$.scrollView.offsetHeight-a.offsetHeight+"px",1<n?(l.classList.remove("smart-hidden"),e._scrollView.scrollWidth+=l.offsetWidth,e.$.scrollView.classList.add("vscroll"),e.$.columnFarContainerElement.classList.add("vscroll"),e.htmlColumnLastChild.classList.remove("smart-visibility-hidden")):e._scrollView.scrollTop=0,0<o&&0<n?(a.classList.add("bottom-corner"),l.classList.add("bottom-corner"),e.$.scrollView.classList.add("hscroll")):e._scrollView.scrollLeft=0,l.refresh(),a.refresh(),0<e.$.rowFarContainer.offsetHeight&&(l.style.height=e.$.scrollView.offsetHeight-a.offsetHeight-e.$.rowFarContainer.offsetHeight+"px",l.style.setProperty("--pseudo-element-height",e.$.rowFarContainer.offsetHeight+"px"),l.refresh())}_styleChangedHandler(e){const t=this;if(e.overflow||e.overflowX||e.overflowY){const e=getComputedStyle(t);t._overflowX=e.overflowX,t._overflowY=e.overflowY}t._refreshLayout(),t._recycle()}_swipeLeftHandler(){}_swipeRightHandler(){}_getRowIndexByPosition(e){const t=this,l=t.rowHierarchy?t.rowHierarchy:t.rows,a=(l=>{let a=0,o=l.length-1;if(0>=e)return 0;const n=l[l.length-1];if(n.top<=e)return l.length-1;for(;!0;){const n=Math.floor((a+o)/2),s=l[n];if(t._isRowInPosition(s,e))return n;s.top<e?a=n+1:s.top>e&&(o=n-1)}})(l);return a}_isRowInPosition(e,t){const l=e.top,a=e.top+e.height;return l<=t&&a>t}_renderColumnGroupHeaders(){const e=this;for(let t=0;t<e.columnGroups.length;t++){const l=e.columnGroups[t],a=l.headerCellElement.firstChild;if(a.innerHTML="<span>"+l.label+"</span>",a.className="smart-label",l.rotationAngle){const t=e._rotateColumnHeader(a,l,l.label);if(!t)continue}e._alignColumnHeader(a,l)}}_renderColumnHeaderCellElement(e,t){const l=this;if(t){const a=e.firstChild;if(a.innerHTML="<span>"+t.label+"</span>",a.className="smart-label",e.classList.remove("smart-hidden"),e.style.width=t.computedWidth+"px",e.style.height=t.computedHeight+"px",e.style.lineHeight=t.computedHeight+"px",e.style.left=t.left+"px",e.style.top=t.top+"px",e.setAttribute("data-field",t.dataField),(t.adaptiveVisible||!t.visible)&&e.classList.add("smart-hidden"),t.rotationAngle){const e=l._rotateColumnHeader(a,t,t.label);if(!e)return}l._alignColumnHeader(a,t),0<t.level&&(e.style.top=t.top+"px")}}_renderAdaptiveRow(e,t){var l=Math.min;const a=this;let o=!1;if(a._toggledRow&&a.appearance.allowRowToggleAnimation&&a._toggledRow.expanded)for(let l=t.parent;l;){if(l.uid===a._toggledRow.uid){const n=l.rowElement.adaptiveDetail;e.classList.add("smart-hidden"),e=a._createRowElement(t),e.toggleArrow.classList.add("smart-hidden"),o=!0,n.appendChild(e);break}l=l.parent}const n=e.adaptiveDetail;if(e.row=t,e.visible=t.visible,t.rowElement=e,e.style.height!==t.height+"px"&&(e.style.height=t.height+"px"),e.style.lineHeight!==t.height+"px"&&(e.style.lineHeight=t.height+"px"),n.classList.remove("smart-hidden"),n.style.height!==t.adaptiveHeight+"px"&&(n.style.height=t.adaptiveHeight+"px"),n.style.lineHeight!==t.adaptiveHeight+"px"&&(n.style.lineHeight=t.adaptiveHeight+"px"),t.expandHeight){if(t.expanded){const o=l(a._clientSize.height,t.height+t.expandHeight)+"px";e.style.height=o,e.style.lineHeight=o}const o=l(a._clientSize.height,t.height+t.expandHeight)+"px";n.style.height=o,n.style.lineHeight=o}else n.innerHTML="";n.style.top=o?t.cellHeight+"px":"0px";const s=document.createDocumentFragment();let d=0,r=0;for(let l=0;l<a._columns.length;l++){const e=a._columns[l];if(e.autoGenerated)continue;const o=a._createColumnHeaderCellElement(e),n=a._createCellElement(e,t);if(t.label){s.appendChild(n),n.classList.add("smart-grid-adaptive-cell"),n.style.height=t.cellHeight+"px",n.style.lineHeight=t.cellHeight+"px",n.style.left="0px",n.style.top="0px",a._renderCellElement(t,e,n),n.style.width="100%";break}n.classList.add("smart-grid-adaptive-cell"),o.classList.add("smart-grid-adaptive-column"),a._renderColumnHeaderCellElement(o,e),a._renderCellElement(t,e,n);const c=1===a._adaptiveLayout?"100%":"50%";o.style.width=c,o.style.height=t.cellHeight+"px",o.style.lineHeight=t.cellHeight+"px",o.style.top=d+"px",o.classList.remove("smart-hidden"),n.style.width=c,n.style.height=t.cellHeight+"px",n.style.lineHeight=t.cellHeight+"px",n.style.top=d+t.cellHeight+"px","100%"==c?(o.style.left="0px",n.style.left="0px"):0===r?(o.style.left="0px",n.style.left="0px",r="50%"):(o.style.left="50%",n.style.left="50%"),0==(l+1)%a._adaptiveLayout&&(r=0,d+=2*t.cellHeight),s.appendChild(o),s.appendChild(n)}n.appendChild(s),e.visible?e.classList.remove("smart-hidden"):e.classList.add("smart-hidden")}_renderRowElement(e,t){const l=this;if(!l._toggledRow&&e.classList.contains("animation"))return e.classList.remove("animation"),e.rowContainer.innerHTML="",e.rowContainer.classList.add("smart-hidden"),l._refreshLayout(),void l._recycle();if(t.adaptiveHeight&&!l._responsiveLayout)return void l._renderAdaptiveRow(e,t);const a=parseInt(l.$.columnNearContainerElement.style.width),o=parseInt(l.$.columnContainerElement.style.width),n=parseInt(l.$.columnFarContainerElement.style.width),s=e.children[1],d=e.children[0],r=e.children[2];if(l._toggledRow&&l.appearance.allowRowToggleAnimation){let a=t.parent;if(!l._toggledRow.expanded&&l._toggledRow.uid===t.uid){const t=e.rowContainer;for(let e=0;e<t.children.length;e++){const a=t.children[e],o=a.getAttribute("data-id"),n=l.rowById[o];a.getAttribute("data-rendered")||(a.setAttribute("data-rendered",!0),l._renderRowElement(a,n))}}for(;a;){if(a.uid===l._toggledRow.uid){const o=a.rowElement.rowContainer;if(l._toggledRow.expanded){e.classList.add("smart-hidden"),e=l._createRowElement(t);for(let l=0;l<o.children.length;l++){const a=o.children[l];if(a.getAttribute("data-id")===t.uid.toString())return void(e=a)}o.appendChild(e),o.classList.remove("smart-hidden")}break}a=a.parent}}if(e.row=t,e.setAttribute("data-id",t.uid),e.visible=t.visible,e.cellsNearContainerElement.classList.remove("smart-visibility-hidden"),e.cellsContainerElement.classList.remove("smart-visibility-hidden"),e.cellsFarContainerElement.classList.remove("smart-visibility-hidden"),t.rowElement=e,e.style.height!==t.height+"px"&&(e.style.height=t.height+"px"),e.style.lineHeight!==t.height+"px"&&(e.style.lineHeight=t.height+"px"),s.style.left!==-l._scrollView.scrollLeft+"px"&&(s.style.left=-l._scrollView.scrollLeft+"px"),t.expanded&&0<t.expandHeight){const l=e.rowContainer;l.style.height!==t.expandHeight+"px"&&(l.style.height=t.expandHeight+"px"),l.style.lineHeight!==t.expandHeight+"px"&&(l.style.lineHeight=t.expandHeight+"px"),l.style.top!==t.cellHeight+"px"&&(l.style.top=t.cellHeight+"px")}if(l.adaptivityMode.adaptiveLayout.enabled){const t=e.adaptiveDetail;t.classList.add("smart-hidden")}if(l.adaptivityMode.responsiveLayout.enabled&&!t.label){const a=e.adaptiveDetail;if(t.adaptiveDetailExpanded||l.adaptivityMode.responsiveLayout.autoShowHiddenCells&&t.adaptiveHeight){a.classList.remove("smart-hidden"),a.style.height!==t.adaptiveHeight+"px"&&(a.style.height=t.adaptiveHeight+"px"),a.style.lineHeight!==t.adaptiveHeight+"px"&&(a.style.lineHeight=t.adaptiveHeight+"px"),a.style.top!==t.cellHeight+"px"&&(a.style.top=t.cellHeight+"px");let e=0,o=25,n=0;const s=document.createDocumentFragment();for(let a=0;a<l._columns.length;a++){const d=l._columns[a];if(!d.autoGenerated&&d.adaptiveVisible){0===n&&(n=a);const r=t.dataRow;let c=d.displayField?r[d.displayField]:r[d.dataField];void 0===c&&(c="");const h=document.createElement("div"),m=l._columns[e].computedWidth,u=l._columns[e].left;h.classList.add("smart-grid-cell","smart-grid-responsive-cell"),h.style.width=m+"px",h.style.height=t.cellHeight+"px",h.style.lineHeight=t.cellHeight+"px",h.style.top=o+"px",h.style.left=u+"px",h.innerHTML=d.label+": "+c,e++,e===n&&(o+=t.cellHeight,e=0),s.appendChild(h)}}a.innerHTML="",a.appendChild(s)}else a.classList.add("smart-hidden")}if(l.rowDetail.enabled){const a=e.detail;t.detailExpanded?(a.classList.remove("smart-hidden"),a.style.height!==t.detailHeight+"px"&&(a.style.height=t.detailHeight+"px"),a.style.lineHeight!==t.detailHeight+"px"&&(a.style.lineHeight=t.detailHeight+"px"),a.style.top!==t.cellHeight+"px"&&(a.style.top=t.cellHeight+"px"),t.adaptiveHeight&&(a.style.top=t.adaptiveHeight+"px"),a.innerHTML=l.rowDetail.template):a.classList.add("smart-hidden")}d.classList.remove("smart-hidden"),r.classList.remove("smart-hidden"),d.style.width!==a+"px"&&(d.style.width=a+"px"),s.style.width!==o+"px"&&(s.style.width=o+"px"),r.style.width!==n+"px"&&(r.style.width=n+"px"),0===n&&r.classList.add("smart-hidden"),0===a&&d.classList.add("smart-hidden");for(let a=0;a<l._fixedNearColumns.length;a++){const o=l._fixedNearColumns[a],n=e.children[0].children[a];l._renderCellElement(t,o,n)}for(let a=0;a<l._fixedFarColumns.length;a++){const o=l._fixedFarColumns[a],n=e.children[2].children[a];l._renderCellElement(t,o,n)}for(let a=0;a<l._columnElements.length;a++){const o=l._columnElements[a],n=o.column;if(!o.parentNode)break;let s=e.children[1].children[a];s||(!o.column&&(o.column=n),s=l._createCellElement(n),e.children[1].appendChild(s)),l._renderCellElement(t,n,s)}e.visible?e.classList.remove("smart-hidden"):e.classList.add("smart-hidden"),l.rowTemplate&&l._handleRowTemplate(l.rowTemplate)&&l._applyTemplate(e,!1)}_renderCellElement(e,t,l){const a=this;if(!t)return void l.classList.add("smart-hidden");const o=e.dataRow;let n=t.displayField?o[t.displayField]:o[t.dataField];if(void 0===n&&(n=""),e.label&&t.treeColumn&&(n=e.label,a.appearance.showRowGroupLabel)){let t=e.boundSource.length;a.hierarchySummaryRow.visible&&t--,n="<span>"+a.columnByDataField[e.groupDataField].label+"</span>: <span>"+e.label+"</span>",a.appearance.showRowGroupCount&&(n+="<span class='count'> ("+t+")</span>")}const s=l.firstChild;if(a.rowDetail.enabled&&e.detailExpanded&&(l.style.height=e.cellHeight+"px",l.style.lineHeight=e.cellHeight+"px"),(e.adaptiveDetailExpanded||a.adaptivityMode.responsiveLayout.autoShowHiddenCells&&e.adaptiveHeight)&&(l.style.height=e.cellHeight+"px",l.style.lineHeight=e.cellHeight+"px"),e.expanded&&0<e.expandHeight&&(l.style.height=e.cellHeight+"px",l.style.lineHeight=e.cellHeight+"px"),s.className="",s.classList.contains("smart-label")||s.classList.add("smart-label"),l.style.width!==t.computedWidth+"px"&&(l.style.width=t.computedWidth+"px"),l.style.left!==t.left+"px"&&(l.style.left=t.left+"px"),l.classList.contains("smart-hidden")&&l.classList.remove("smart-hidden"),e.label&&(t.treeColumn?l.style.width="100%":l.classList.add("smart-hidden")),l.classList.contains("smart-grid-cell-fixed")&&l.classList.remove("smart-grid-cell-fixed"),l.classList.remove("smart-grid-group-row-cell"),a.dataSource.groupBy&&(l.classList.remove("smart-grid-group-header-row-cell"),e.label&&l.classList.add("smart-grid-group-header-row-cell"),l.classList.add("smart-grid-group-row-cell")),e.filterRow?l.classList.add("smart-grid-filter-row-cell"):e.summaryRow?l.classList.add("smart-grid-summary-row-cell"):(t.fixed||e.fixed)&&(a.rowDetail.enabled&&a.rowDetail.visible&&t.toggleColumn&&(s.classList.remove("animation"),e.detailExpanded?(s.classList.remove("smart-arrow-right"),s.classList.add("smart-arrow-down")):(s.classList.remove("smart-arrow-down"),s.classList.add("smart-arrow-right")),300>new Date-a._lastPointerDownTime&&s.classList.add("animation")),t.rowNumbersColumn&&l.classList.add("smart-grid-row-header-cell"),t.toggleColumn&&l.classList.add("smart-grid-row-detail-cell"),t.adaptiveColumn?l.classList.add("smart-grid-row-adaptive-detail-cell"):l.classList.add("smart-grid-cell-fixed")),t.cellsRotationAngle){const e=a._rotateCellContent(s,t,n);if(!e)return}else if(e.filterRow)t.adaptiveColumn||t.toggleColumn||t.rowNumbersColumn?s.innerHTML="":!t.filterEditorInitialized&&(t.filterEditorInitialized=!0);else if(e.summaryRow){if(t.adaptiveColumn||t.toggleColumn||t.rowNumbersColumn)s.innerHTML="";else if(0<t.summary.length&&a._summaryItems){const l=a._summaryItems[t.dataField];let o=0;for(let t in l)o===e.summaryRowIndex&&(s.innerHTML=a.localize(t,{value:l[t]})),o++}}else if(a.rowDetail.enabled&&t.toggleColumn)""!==s.innerHTML&&(s.innerHTML="");else if(t.adaptiveColumn)l.removeAttribute("expanded"),e.adaptiveDetailExpanded&&l.setAttribute("expanded",!0),300>new Date-a._lastPointerDownTime&&s.classList.add("animation"),l.classList.add("smart-grid-cell-adaptive");else if(a.appearance.showRowNumber&&t.rowNumbersColumn)s.innerHTML=e.boundIndex+1;else if(t.onCellRendered)requestAnimationFrame(function(){if(t._cellsCachedValues[e.boundIndex]){const l=t._cellsCachedValues[e.boundIndex];s.firstChild&&s.removeChild(s.firstChild),s.appendChild(l)}else{const l=document.createElement("div");s.firstChild&&s.removeChild(s.firstChild),s.appendChild(l);const a={data:e.dataRow,column:t,value:n,rowIndex:e.boundIndex,rowVisibleIndex:e.visibleIndex,cellElement:l};t.onCellRendered(a),t._cellsCachedValues[e.boundIndex]=l}});else if(t.treeColumn&&a.dataSource.itemHierarchy){const t=s.children[0],l=s.children[1],o=s.children[2];t.classList.add("smart-indent-container"),300<new Date-a._lastPointerDownTime&&l.classList.remove("animation"),e.leaf?(l.classList.remove("smart-arrow-down"),l.classList.add("smart-arrow-right"),l.classList.add("smart-visibility-hidden")):(l.classList.remove("smart-visibility-hidden"),e.expanded?(l.classList.remove("smart-arrow-right"),l.classList.add("smart-arrow-down")):(l.classList.remove("smart-arrow-down"),l.classList.add("smart-arrow-right")));let d="";for(let t=0;t<e.level;t++)d+="<div class='smart-indent'></div>";0<a._adaptiveLayout&&(l.classList.add("smart-hidden"),d=""),t.innerHTML=d,o.innerHTML=n,a.appearance.showTooltips&&o.setAttribute("title",e.label?e.label:n)}else{const e=s.firstChild;if(e&&e.classList&&e.classList.contains("smart-indent-container")){const e=s.children[0],t=s.children[1],l=s.children[2];e.innerHTML="",t.classList.add("smart-visibility-hidden"),l.innerHTML=n,a.appearance.showTooltips&&l.setAttribute("title",n)}else s.innerHTML=n,a.appearance.showTooltips&&s.setAttribute("title",n)}if(t.formatFunction){const l=t.formatFunction(i,n,e);void 0!==l&&(s.innerHTML=l)}a._alignCellContent(s,t)}_recycle(){const e=this;if(!e._rowElements)return;let t=e._height;e._height||(t=e._height=e.$.scrollView.offsetHeight);const l=e._scrollView.scrollTop,a=e._getRowIndexByPosition(l),o=e.rowHierarchy?e.rowHierarchy:e.rows,n=o[a];let s,d=n?n.top:0;e.isUpdating++;let r=0,c=0;for(let t=0;t<e._columnElements.length;t++){const l=e._columnElements[t];if(!l.parentNode)break;l.column=null,l.classList.add("smart-hidden")}for(let t=0;t<e.columnGroups.length;t++){const l=e.columnGroups[t],a=l.headerCellElement;a.style.left=l.left+"px",a.style.width=l.computedWidth+"px"}for(let t=0;t<e._columns.length;t++){const l=e._columns[t];if(l.fixed){"near"===l.fixPosition&&(r+=l.computedWidth),!l.visible||l.adaptiveVisible?l.headerCellElement.classList.add("smart-hidden"):l.headerCellElement.classList.remove("smart-hidden");continue}if(l.visible&&!l.adaptiveVisible)if(0<e._adaptiveLayout)l.headerCellElement.classList.add("smart-hidden");else if(l.left+l.computedWidth-e._scrollView.scrollLeft>=r&&l.left-l.computedWidth-e._scrollView.scrollLeft<e._clientSize.width){const t=e._columnElements[c++];t.column=l,t.parentNode||e.$.columnContainerElement.appendChild(t),e._renderColumnHeaderCellElement(t,l),void 0===s&&(s=l.left)}}if(void 0===s&&(s=0),e.$.columnContainerElement.style.left=-e._scrollView.scrollLeft+"px",e.$.rowContainer.style.top=e.__fixedNearHeight-l+d+"px",0<=a){c=0;let n=e._overflowOffset;for(let s=a;s<o.length;s++){const a=o[s];if(0===a.height||!a.visible||a.fixed)continue;const r=a.height;if(a.expandHeight&&(n+=a.expandHeight),d+r>=l&&d<=l+t+n){const t=e._rowElements[c++];if(!t)break;e._renderRowElement(t,a)}else break;d+=r}}if(e._renderFixedRows(),c<e._rowElements.length)for(let t=c;t<e._rowElements.length;t++){const t=e._rowElements[c++];t.classList.add("smart-hidden")}e.isUpdating--}_renderFixedRows(){const e=this;for(let t=0;t<e._fixedNearRows.length;t++){const l=e._fixedNearRows[t],a=l.rowElement;e._renderRowElement(a,l)}for(let t=0;t<e._fixedFarRows.length;t++){const l=e._fixedFarRows[t],a=l.rowElement;e._renderRowElement(a,l)}}_rotateCellContent(e,t,l){const a=this,o=document.createElement("span");return e.innerHTML="",o.innerHTML=l,e.appendChild(o),o.className="rotate",o.style.transform="rotate("+t.cellsRotationAngle+"deg)",a._recycleRotate(e,o,t.cellsAlign,t.cellsVerticalAlign,l)}_rotateColumnHeader(e,t,l){const a=this,o=document.createElement("span");return e.innerHTML="",o.innerHTML=l,e.appendChild(o),o.className="rotate",o.style.transform="rotate("+t.rotationAngle+"deg)",a._recycleRotate(e,o,t.align,t.verticalAlign,l)}_recycleRotate(e,t,l,a,o){const n=t.getBoundingClientRect(),s=e.getBoundingClientRect(),d=4;let r=0,c=0;return 0===s.width?(e.innerHTML=o,!1):(n.left>s.left&&(r=s.left-n.left),n.top<s.top&&(c=s.top-n.top),("left"===l||""===l)&&(r=d),"center"===l&&(r+=s.width/2-n.width/2),"right"===l&&(r+=s.width-n.width-d),("top"===a||""===a)&&(c=d),("center"===a||"middle"===a)&&(c+=s.height/2-n.height/2),"bottom"===a&&(c+=s.height-n.height-d),t.style.left=r+"px",t.style.top=c+"px",!0)}_alignColumnHeader(e,t){switch(t.align){case"left":e.classList.add("align-left");break;case"center":e.classList.add("align-center");break;case"right":e.classList.add("align-right");}switch(t.verticalAlign){case"top":e.classList.add("align-top");break;case"middle":e.classList.add("align-middle");break;case"bottom":e.classList.add("align-bottom");}}_alignCellContent(e,t){switch(t.cellsAlign){case"left":e.classList.add("align-left");break;case"center":e.classList.add("align-center");break;case"right":e.classList.add("align-right");}switch(t.cellsVerticalAlign){case"top":e.classList.add("align-top");break;case"middle":e.classList.add("align-middle");break;case"bottom":e.classList.add("align-bottom");}}_verticalScrollbarHandler(e){const t=this;return e.stopPropagation(),t._recycle(),e.context.max===e.context.value?void t.$.fireEvent("scrollBottomReached"):void(e.context.min===e.context.value&&t.$.fireEvent("scrollTopReached"))}});