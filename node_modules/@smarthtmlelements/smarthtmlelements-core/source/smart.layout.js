
/* Smart HTML Elements v1.1.0 (2018-June) 
Copyright (c) 2011-2018 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart("smart-layout",class extends Smart.ContentElement{static get properties(){return{order:{value:"row",type:"string",allowedValues:["row","column","stack"]},disableDragging:{value:!1,type:"boolean"},layout:{value:[],type:"array",reflectToAttribute:!1},messages:{value:{en:{invalidNodeType:"smart-layout: The method \"{{method}}\" requires a \"smart-tabs-window\" element to be passed as an argument."}},type:"object",extend:!0},tooltip:{value:!1,type:"boolean"}}}static get listeners(){return{"document.up":"_documentUpHandler","document.move":"_documentMoveHandler","document.down":"_downHandler",mouseleave:"_mouseLeaveHandler"}}template(){return`<div id="container">
                    <smart-splitter id="itemsContainer" class="smart-layout-items-container">
                        <content></content>
                    </smart-splitter>
                    <smart-tabs-window id="dummyTabsWindow" class="smart-tabs-window-dummy smart-hidden">
                        <smart-tab-item></smart-tab-item>
                    </smart-tabs-window>
                </div>`}propertyChangedHandler(a){const b=this;switch(a){case"order":b._setOrder();break;case"layout":b._handleLayout(),b._resizeItems();break;case"tooltip":}}ready(){super.ready();const a=this;a._dragDetails={},a._setOrder(),a._handleLayout(),a._resizeItems(),a._setFocusable(!0),a.$dummyTabsWindow.removeClass("smart-hidden")}static get requires(){return{"Smart.TabsWindow":"smart.window.js"}}appendChild(a){const b=this;if(!b.isCompleted){const a=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.appendChild.apply(b,a.concat(Array.prototype.slice.call(arguments)))}return a?a instanceof Smart.TabsWindow?void b.$.itemsContainer.appendChild(a):void b.error(b.localize("invalidNodeType",{elementType:b.nodeName.toLowerCase(),method:"appendChild",node:"node"})):void b.error(b.localize("invalidNode",{elementType:b.nodeName.toLowerCase(),method:"appendChild",node:"node"}))}insertBefore(a,b){const c=this;if(!c.isCompleted){const a=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.insertBefore.apply(c,a.concat(Array.prototype.slice.call(arguments)))}return b?b instanceof Smart.TabsWindow?void(c.$.itemsContainer.insertBefore(a,b),c._setIndexes()):void c.error(c.localize("invalidNodeType",{elementType:c.nodeName.toLowerCase(),method:"appendChild",node:"node"})):void c.error(c.localize("invalidNode",{elementType:c.nodeName.toLowerCase(),method:"appendChild",node:"node"}))}insert(a,b){const c=this;b instanceof Smart.TabsWindow&&(a=Math.max(0,Math.min(c._items.length,a)),c._setIndexes(),c._resizeItems())}remove(a){const b=this;"number"==typeof a&&(a=b._items[a]);a instanceof Smart.TabsWindow&&(b.$.container.removeChild(a),b._items.splice(b._items.indexOf(a),1),b._setIndexes(),b._resizeItems())}_setIndexes(){const a=this,b=a.getElementsByTagName("smart-tabs-window"),c=b.length;let d=0;a._items=[];for(let e=1;e<c;e++)b[e]._dataIndex=d++,a._items.push(b[e])}_setFocusable(a){const b=this;if(!b.disabled&&a){let a=0<b.tabIndex?b.tabIndex:0;b.setAttribute("tabindex",a)}else b.removeAttribute("tabindex")}_downHandler(a){const b=this;if(a.target instanceof Smart.TabsWindow){const c=a.originalEvent.target.closest(".smart-tab-label-container");if(c){b._dragDetails.selectedItem=c.closest("smart-splitter-item"),b._dragDetails.selectedTabs=c.closest("smart-tabs-window"),b._dragDetails.selectedTabLabel=c,b._dragDetails.x=a.pageX,b._dragDetails.y=a.pageY;const d=c.closest("smart-layout");d===b?1<b._dragDetails.selectedTabs.items.length?(b._dragDetails.windowDummy=b.$.dummyTabsWindow,b.$.dummyTabsWindow.update(0,b._dragDetails.selectedTabLabel.tab.label,b._dragDetails.selectedTabLabel.tab.content)):b._dragDetails.windowDummy=b._dragDetails.selectedTabs:b._dragDetails.windowDummy=b._dragDetails.selectedTabs,b._items.map(a=>a.removeAttribute("ontop")),b._dragDetails.windowDummy.setAttribute("ontop","")}}}_documentMoveHandler(a){var b=Math.abs,c=Math.max;const d=this;if(!d.disabled&&d._dragDetails.selectedTabs&&!(5>=b(a.pageX-d._dragDetails.x)&&5>=b(a.pageY-d._dragDetails.y))){d.setAttribute("dragged",""),a.originalEvent.stopPropagation();const b=a.originalEvent.target.closest("smart-tabs-window");if(d._dragDetails.windowDummy.setAttribute("tabs-window-dragged",""),d._dragDetails.windowDummy.style.left=a.pageX+"px",d._dragDetails.windowDummy.style.top=a.pageY+"px",d._dragDetails.windowDummy.style.width=d._dragDetails.selectedTabs.offsetWidth+"px",d._dragDetails.windowDummy.style.height=d._dragDetails.selectedTabs.offsetHeight+"px",d._dragDetails.windowDummy.opened=!0,!b)return d._handleSnapping(),void(d._dragDetails.hoveredTabs=d._dragDetails.hoveredTabArea=void 0);d._dragDetails.hoveredItem=b.closest("smart-splitter-item");const e=a.originalEvent.target.closest(".smart-tabs-header-section");d._dragDetails.hoveredTabs=b,d._dragDetails.hoveredTabArea=e?e:d._dragDetails.hoveredTabs.$.tabsElement.$.tabContentSection;let f={};d._dragDetails.selectedItem?(f.left=d._dragDetails.hoveredItem.offsetLeft,f.top=d._dragDetails.hoveredItem.offsetTop):f.left=f.top=0;const g=c(0,a.pageX-window.pageXOffset-d.offsetLeft),h=c(0,a.pageY-window.pageYOffset,d.offsetTop);d._dragDetails.hoveredTabArea===e?(d._dragDetails.hoveredTabArea=a.originalEvent.target.closest(".smart-tab-label-container"),d._handleSnapping("header")):d._dragDetails.hoveredTabArea.classList.contains("smart-tabs-content-section")&&(g<.05*d.$.itemsContainer.offsetWidth?d._handleSnapping("layout-left",a):g>.95*d.$.itemsContainer.offsetWidth?d._handleSnapping("layout-right"):h<.05*d.$.itemsContainer.offsetHeight+d._dragDetails.hoveredTabArea.offsetTop?d._handleSnapping("layout-top"):h>.95*d.$.itemsContainer.offsetHeight?d._handleSnapping("layout-bottom"):g<f.left+.25*d._dragDetails.hoveredTabArea.offsetWidth?d._handleSnapping("left"):g>f.left+.75*d._dragDetails.hoveredTabArea.offsetWidth?d._handleSnapping("right"):h<d._dragDetails.hoveredTabs.offsetTop+d._dragDetails.hoveredTabArea.offsetTop+.5*d._dragDetails.hoveredTabArea.offsetHeight?d._handleSnapping("top"):d._handleSnapping("bottom"))}}_documentUpHandler(a){const b=this;if(b._dragDetails.selectedTabs){if(delete b._dragDetails.windowDummy._splitted,b._dragDetails.windowDummy.style.width="",!a.originalEvent.target.closest("smart-layout")){if(b._dragDetails.windowDummy.classList.contains("smart-tabs-window-dummy")){b._dragDetails.selectedTabs.$.tabsElement.removeChild(b._dragDetails.selectedTabLabel.tab);let c=b._dragDetails.selectedTabs.cloneNode();c.appendChild(b._dragDetails.selectedTabLabel.tab),c.style.left=a.pageX+"px",c.style.top=a.pageY+"px",c.style.maxWidth=c.style.maxHeight="",b.parentElement.appendChild(c),c.pinned=!1,b._items.push(c)}else b._dragDetails.windowDummy.windowParent="body",b._dragDetails.windowDummy.pinned=!1,b._dragDetails.windowDummy.style.maxWidth=b._dragDetails.windowDummy.style.maxHeight="";}else if(b._dragDetails.hoveredTabs){if(b._dragDetails.hoveredTabArea.classList.contains("smart-tabs-header-section")){const c=b._dragDetails.hoveredTabs.itemLabels.length;let d,e=a.originalEvent.target.closest(".smart-tab-label-container");if(e||(e=b._dragDetails.hoveredTabs.itemLabels[c-1],d=!0),b._dragDetails.selectedTabs===b._dragDetails.hoveredTabs){let a=b._dragDetails.hoveredTabs.$.tabsElement.context;b._dragDetails.hoveredTabs.$.tabsElement.context=b._dragDetails.hoveredTabs.$.tabsElement,b._dragDetails.hoveredTabs.$.tabsElement._reorderTabs(b._dragDetails.selectedTabLabel.tab.index,e.tab.index),b._dragDetails.hoveredTabs.$.tabsElement.context=a}else b._dragDetails.hoveredTabs.insert(d?c:e.tab.index,{label:b._dragDetails.selectedTabLabel.tab.label,content:b._dragDetails.selectedTabLabel.tab.content}),b._dragDetails.selectedTabs.$.tabsElement.removeChild(b._dragDetails.selectedTabLabel.tab)}else if(b._snapDummy.classList.contains("smart-window-snap-right-dummy")){let a=b._dragDetails.windowDummy;if(a.classList.contains("smart-tabs-window-dummy")){b._dragDetails.selectedTabs.$.tabsElement.removeChild(b._dragDetails.selectedTabLabel.tab);let c=b._dragDetails.selectedTabs.cloneNode();c.id="",c.appendChild(b._dragDetails.selectedTabLabel.tab),c.style.left=c.style.top="",a=c}b._dragDetails.hoveredTabs._splitted=a._splitted=!0,b._dragDetails.hoveredTabs.style.width=a.style.width=b._dragDetails.hoveredTabs.offsetWidth/2+"px",b.insert(b._dragDetails.hoveredTabs._dataIndex,a,!0)}b._dragDetails.windowDummy.windowParent=null}return 0===b._dragDetails.windowDummy.$.tabsElement._tabs.length&&(b._dragDetails.windowDummy.parentElement.removeChild(b._dragDetails.windowDummy),b._items.splice(b._items.indexOf(b._dragDetails.windowDummy),1)),b._dragDetails.windowDummy.removeAttribute("tabs-window-dragged"),b._dragDetails.windowDummy.removeAttribute("ontop"),b._dragDetails.selectedTabs=b._dragDetails.hoveredTabs=void 0,b._handleSnapping(),b.removeAttribute("dragged"),b._dragDetails.windowDummy.classList.contains("smart-tabs-window-dummy")&&(b._dragDetails.windowDummy.opened=!1),b._dragDetails.windowDummy.closest("smart-layout")?void(b._dragDetails.windowDummy.style.top=b._dragDetails.windowDummy.style.left=""):void(b._dragDetails.windowDummy.top&&(b._dragDetails.windowDummy.style.top=b._dragDetails.windowDummy.top),b._dragDetails.windowDummy.left&&(b._dragDetails.windowDummy.style.left=b._dragDetails.windowDummy.left))}}_handleLayout(){function a(a,b){let c,d=document.createElement("smart-tabs-window"),e=document.createElement("smart-splitter-item");if(a.id&&(e.id=a.id),e.size=a.size||"",e.size=a.min||"",e.size=a.max||"",d.closeButtons=!!a.closeButtons&&a.closeButtons,d.opened=d.pinned=!0,d._dataIndex=b,a.items&&a.items instanceof Array)for(let b=0;b<a.items.length;b++)c=document.createElement("smart-tab-item"),c.selected=!!a.items[b].selected&&a.items[b].selected,c.label=!!a.items[b].label&&a.items[b].label,c.content=a.items[b].content?a.items[b].content:"",d.appendChild(c);return e.appendChild(d),e}const b=this;b._items=[],"string"==typeof b.layout&&(b.layout=JSON.parse(b.layout));let c;if(null!==b.layout&&b.layout instanceof Array){b.$.itemsContainer.removeAll();let c;for(let d=0;d<b.layout.length;d++)b.$.itemsContainer.appendChild(c=a(b.layout[d],d)),b._items.push(c);return}const d=Array.from(b.$.itemsContainer.children);b.$.itemsContainer.innerHTML="";for(let a=0;a<d.length;a++)b.$.itemsContainer.appendChild(c=document.createElement("smart-splitter-item").appendChild(d[a])),b._items.push(c)}_resizeItems(){this}_setOrder(){const a=this;"row"===a.order?a.$.itemsContainer.orientation="vertical":"column"===a.order?a.$.itemsContainer.orientation="horizontal":"stack"===a.order}_handleSnapping(a){const b=this;if(!a)return void(b._snapDummy&&b._snapDummy.parentElement&&b._snapDummy.classList.add("smart-visibility-hidden"));b._snapDummy||(b._snapDummy=document.createElement("div"),b._snapDummy.addEventListener("transitionend",function(){b._snapDummy.classList.contains("smart-visibility-hidden")&&b._snapDummy.parentElement&&b._snapDummy.parentElement.removeChild(b._snapDummy)})),b._snapDummy.className="smart-window-snap-"+a+"-dummy",b._snapDummy._position=a,b._snapDummy.style.left=b._snapDummy.style.width="";let c,d,e,f;const g=5;switch(a){case"header":{const a=b._dragDetails.hoveredTabs.$.tabsElement;if(b._dragDetails.hoveredTabArea)c=b._dragDetails.hoveredTabArea.offsetWidth+"px",d=b._dragDetails.hoveredTabArea.offsetHeight,b._snapDummy.style.left=b._dragDetails.hoveredItem.offsetLeft+b._dragDetails.hoveredTabArea.offsetLeft+3+"px";else{let e;if(0<a.$.tabStrip.children.length){const e=a.$.tabStrip.children[a.$.tabStrip.children.length-1];c=e.offsetWidth+"px",d=e.offsetHeight,b._snapDummy.style.left=b._dragDetails.hoveredItem.offsetLeft+e.offsetLeft+e.offsetWidth+g+"px"}else c="",d=e.offsetHeight,b._snapDummy.style.left=b._dragDetails.hoveredItem.offsetLeft+e.offsetLeft+e.offsetWidth+g+"px"}b._dragDetails.hoveredTabArea=a.$.tabsHeaderSection,e=b._dragDetails.hoveredTabs.offsetTop+b._dragDetails.hoveredTabArea.offsetTop+3,b._snapDummy.style.width=c}break;case"left":case"right":d=b._dragDetails.hoveredTabArea.offsetHeight-g,c=b._dragDetails.hoveredTabArea.offsetWidth/2+g,e=b._dragDetails.hoveredTabs.offsetTop+b._dragDetails.hoveredTabArea.offsetTop+g,f=b._dragDetails.hoveredItem.offsetLeft+("right"===a?b._dragDetails.hoveredTabArea.offsetWidth/2:g);break;case"top":case"bottom":d=b._dragDetails.hoveredTabArea.offsetHeight/2-g,c=b._dragDetails.hoveredTabArea.offsetWidth,e=g+b._dragDetails.hoveredItem.offsetTop+b._dragDetails.hoveredTabArea.offsetTop+("bottom"===a?b._dragDetails.hoveredTabArea.offsetHeight/2:0),f=b._dragDetails.hoveredItem.offsetLeft+("right"===a?b._dragDetails.hoveredTabArea.offsetWidth/2:g);break;case"layout-left":case"layout-right":d=b.$.container.offsetHeight-10,e=g;break;case"layout-top":case"layout-bottom":d=.15*b._dragDetails.hoveredTabs.offsetHeight,e=b._dragDetails.hoveredTabs.offsetTop+("layout-top"===a?b._dragDetails.hoveredTabArea.offsetTop:b._dragDetails.hoveredTabs.offsetHeight-d),e="layout-top"===a?e+g:e-g;}b._snapDummy.style.height=d+"px",b._snapDummy.style.width=c+"px",b._snapDummy.style.left=f+"px",b._snapDummy.style.top=e+"px",b._snapDummy.parentElement||b.$.container.appendChild(b._snapDummy)}});